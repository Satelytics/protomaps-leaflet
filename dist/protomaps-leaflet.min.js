var protomapsL=(()=>{var Ii=Object.create;var Be=Object.defineProperty;var Xi=Object.getOwnPropertyDescriptor;var Vi=Object.getOwnPropertyNames,ir=Object.getOwnPropertySymbols,Yi=Object.getPrototypeOf,nr=Object.prototype.hasOwnProperty,Ui=Object.prototype.propertyIsEnumerable;var ar=(t,e,r)=>e in t?Be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sr=(t,e)=>{for(var r in e||(e={}))nr.call(e,r)&&ar(t,r,e[r]);if(ir)for(var r of ir(e))Ui.call(e,r)&&ar(t,r,e[r]);return t};var or=t=>Be(t,"__esModule",{value:!0});var W=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ji=(t,e)=>{or(t);for(var r in e)Be(t,r,{get:e[r],enumerable:!0})},Ni=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Vi(e))!nr.call(t,i)&&i!=="default"&&Be(t,i,{get:()=>e[i],enumerable:!(r=Xi(e,i))||r.enumerable});return t},Y=t=>Ni(or(Be(t!=null?Ii(Yi(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var E=(t,e,r)=>new Promise((i,n)=>{var a=l=>{try{o(r.next(l))}catch(u){n(u)}},s=l=>{try{o(r.throw(l))}catch(u){n(u)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((r=r.apply(t,e)).next())});var ie=W((Xa,lr)=>{"use strict";lr.exports=be;function be(t,e){this.x=t,this.y=e}be.prototype={clone:function(){return new be(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=e*this.x-r*this.y,n=r*this.x+e*this.y;return this.x=i,this.y=n,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),n=e.x+r*(this.x-e.x)-i*(this.y-e.y),a=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=n,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};be.convert=function(t){return t instanceof be?t:Array.isArray(t)?new be(t[0],t[1]):t}});var gt=W((Va,ur)=>{"use strict";var $i=ie();ur.exports=we;function we(t,e,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=n,t.readFields(qi,this,e)}function qi(t,e,r){t==1?e.id=r.readVarint():t==2?Hi(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function Hi(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}we.types=["Unknown","Point","LineString","Polygon"];we.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,a=0,s=[],o;t.pos<e;){if(i<=0){var l=t.readVarint();r=l&7,i=l>>3}if(i--,r===1||r===2)n+=t.readSVarint(),a+=t.readSVarint(),r===1&&(o&&s.push(o),o=[]),o.push(new $i(n,a));else if(r===7)o&&o.push(o[0].clone());else throw new Error("unknown command "+r)}return o&&s.push(o),s};we.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,a=0,s=1/0,o=-1/0,l=1/0,u=-1/0;t.pos<e;){if(i<=0){var h=t.readVarint();r=h&7,i=h>>3}if(i--,r===1||r===2)n+=t.readSVarint(),a+=t.readSVarint(),n<s&&(s=n),n>o&&(o=n),a<l&&(l=a),a>u&&(u=a);else if(r!==7)throw new Error("unknown command "+r)}return[s,l,o,u]};we.prototype.toGeoJSON=function(t,e,r){var i=this.extent*Math.pow(2,r),n=this.extent*t,a=this.extent*e,s=this.loadGeometry(),o=we.types[this.type],l,u;function h(g){for(var w=0;w<g.length;w++){var v=g[w],d=180-(v.y+a)*360/i;g[w]=[(v.x+n)*360/i-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(l=0;l<s.length;l++)f[l]=s[l][0];s=f,h(s);break;case 2:for(l=0;l<s.length;l++)h(s[l]);break;case 3:for(s=Zi(s),l=0;l<s.length;l++)for(u=0;u<s[l].length;u++)h(s[l][u]);break}s.length===1?s=s[0]:o="Multi"+o;var c={type:"Feature",geometry:{type:o,coordinates:s},properties:this.properties};return"id"in this&&(c.id=this.id),c};function Zi(t){var e=t.length;if(e<=1)return[t];for(var r=[],i,n,a=0;a<e;a++){var s=Wi(t[a]);s!==0&&(n===void 0&&(n=s<0),n===s<0?(i&&r.push(i),i=[t[a]]):i.push(t[a]))}return i&&r.push(i),r}function Wi(t){for(var e=0,r=0,i=t.length,n=i-1,a,s;r<i;n=r++)a=t[r],s=t[n],e+=(s.x-a.x)*(a.y+s.y);return e}});var xt=W((Ya,fr)=>{"use strict";var Ki=gt();fr.exports=hr;function hr(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ji,this,e),this.length=this._features.length}function Ji(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(Gi(r))}function Gi(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var i=t.readVarint()>>3;e=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null}return e}hr.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Ki(this._pbf,e,this.extent,this._keys,this._values)}});var cr=W((Ua,dr)=>{"use strict";var Qi=xt();dr.exports=en;function en(t,e){this.layers=t.readFields(tn,{},e)}function tn(t,e,r){if(t===3){var i=new Qi(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}});var mr=W((ja,et)=>{et.exports.VectorTile=cr();et.exports.VectorTileFeature=gt();et.exports.VectorTileLayer=xt()});var pr=W(bt=>{bt.read=function(t,e,r,i,n){var a,s,o=n*8-i-1,l=(1<<o)-1,u=l>>1,h=-7,f=r?n-1:0,c=r?-1:1,g=t[e+f];for(f+=c,a=g&(1<<-h)-1,g>>=-h,h+=o;h>0;a=a*256+t[e+f],f+=c,h-=8);for(s=a&(1<<-h)-1,a>>=-h,h+=i;h>0;s=s*256+t[e+f],f+=c,h-=8);if(a===0)a=1-u;else{if(a===l)return s?NaN:(g?-1:1)*(1/0);s=s+Math.pow(2,i),a=a-u}return(g?-1:1)*s*Math.pow(2,a-i)};bt.write=function(t,e,r,i,n,a){var s,o,l,u=a*8-n-1,h=(1<<u)-1,f=h>>1,c=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:a-1,w=i?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+f>=1?e+=c/l:e+=c*Math.pow(2,1-f),e*l>=2&&(s++,l/=2),s+f>=h?(o=0,s=h):s+f>=1?(o=(e*l-1)*Math.pow(2,n),s=s+f):(o=e*Math.pow(2,f-1)*Math.pow(2,n),s=0));n>=8;t[r+g]=o&255,g+=w,o/=256,n-=8);for(s=s<<n|o,u+=n;u>0;t[r+g]=s&255,g+=w,s/=256,u-=8);t[r+g-w]|=v*128}});var vr=W(($a,wr)=>{"use strict";wr.exports=M;var tt=pr();function M(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}M.Varint=0;M.Fixed64=1;M.Bytes=2;M.Fixed32=5;var wt=(1<<16)*(1<<16),yr=1/wt,rn=12,gr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");M.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,a=this.pos;this.type=i&7,t(n,e,this),this.pos===a&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=rt(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=br(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=rt(this.buf,this.pos)+rt(this.buf,this.pos+4)*wt;return this.pos+=8,t},readSFixed64:function(){var t=rt(this.buf,this.pos)+br(this.buf,this.pos+4)*wt;return this.pos+=8,t},readFloat:function(){var t=tt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=tt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r,i;return i=e[this.pos++],r=i&127,i<128||(i=e[this.pos++],r|=(i&127)<<7,i<128)||(i=e[this.pos++],r|=(i&127)<<14,i<128)||(i=e[this.pos++],r|=(i&127)<<21,i<128)?r:(i=e[this.pos],r|=(i&15)<<28,nn(r,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=rn&&gr?xn(this.buf,e,t):gn(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==M.Bytes)return t.push(this.readVarint(e));var r=ne(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==M.Bytes)return t.push(this.readSVarint());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==M.Bytes)return t.push(this.readBoolean());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==M.Bytes)return t.push(this.readFloat());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==M.Bytes)return t.push(this.readDouble());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==M.Bytes)return t.push(this.readFixed32());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==M.Bytes)return t.push(this.readSFixed32());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==M.Bytes)return t.push(this.readFixed64());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==M.Bytes)return t.push(this.readSFixed64());var e=ne(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===M.Varint)for(;this.buf[this.pos++]>127;);else if(e===M.Bytes)this.pos=this.readVarint()+this.pos;else if(e===M.Fixed32)this.pos+=4;else if(e===M.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),_e(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),_e(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),_e(this.buf,t&-1,this.pos),_e(this.buf,Math.floor(t*yr),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),_e(this.buf,t&-1,this.pos),_e(this.buf,Math.floor(t*yr),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){an(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=bn(this.buf,t,this.pos);var r=this.pos-e;r>=128&&xr(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),tt.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),tt.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;i>=128&&xr(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,M.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,ln,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,un,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,dn,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,hn,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,fn,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,cn,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,mn,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,pn,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,yn,e)},writeBytesField:function(t,e){this.writeTag(t,M.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,M.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,M.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,M.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,M.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,M.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,M.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,M.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,M.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,M.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};function nn(t,e,r){var i=r.buf,n,a;if(a=i[r.pos++],n=(a&112)>>4,a<128||(a=i[r.pos++],n|=(a&127)<<3,a<128)||(a=i[r.pos++],n|=(a&127)<<10,a<128)||(a=i[r.pos++],n|=(a&127)<<17,a<128)||(a=i[r.pos++],n|=(a&127)<<24,a<128)||(a=i[r.pos++],n|=(a&1)<<31,a<128))return ve(t,n,e);throw new Error("Expected varint not more than 10 bytes")}function ne(t){return t.type===M.Bytes?t.readVarint()+t.pos:t.pos+1}function ve(t,e,r){return r?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function an(t,e){var r,i;if(t>=0?(r=t%4294967296|0,i=t/4294967296|0):(r=~(-t%4294967296),i=~(-t/4294967296),r^4294967295?r=r+1|0:(r=0,i=i+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),sn(r,i,e),on(i,e)}function sn(t,e,r){r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos]=t&127}function on(t,e){var r=(t&7)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127)))))}function xr(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));r.realloc(i);for(var n=r.pos-1;n>=t;n--)r.buf[n+i]=r.buf[n]}function ln(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function un(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function hn(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function fn(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function dn(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function cn(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function mn(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function pn(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function yn(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function rt(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function _e(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function br(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function gn(t,e,r){for(var i="",n=e;n<r;){var a=t[n],s=null,o=a>239?4:a>223?3:a>191?2:1;if(n+o>r)break;var l,u,h;o===1?a<128&&(s=a):o===2?(l=t[n+1],(l&192)==128&&(s=(a&31)<<6|l&63,s<=127&&(s=null))):o===3?(l=t[n+1],u=t[n+2],(l&192)==128&&(u&192)==128&&(s=(a&15)<<12|(l&63)<<6|u&63,(s<=2047||s>=55296&&s<=57343)&&(s=null))):o===4&&(l=t[n+1],u=t[n+2],h=t[n+3],(l&192)==128&&(u&192)==128&&(h&192)==128&&(s=(a&15)<<18|(l&63)<<12|(u&63)<<6|h&63,(s<=65535||s>=1114112)&&(s=null))),s===null?(s=65533,o=1):s>65535&&(s-=65536,i+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),i+=String.fromCharCode(s),n+=o}return i}function xn(t,e,r){return gr.decode(t.subarray(e,r))}function bn(t,e,r){for(var i=0,n,a;i<e.length;i++){if(n=e.charCodeAt(i),n>55295&&n<57344)if(a)if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,a=n;continue}else n=a-55296<<10|n-56320|65536,a=null;else{n>56319||i+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):a=n;continue}else a&&(t[r++]=239,t[r++]=191,t[r++]=189,a=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=n&63|128)}return r}});var Ct=W((Ha,Zr)=>{"use strict";var vt=Object.defineProperty,wn=Object.getOwnPropertyDescriptor,vn=Object.getOwnPropertyNames,_n=Object.prototype.hasOwnProperty,zn=(t,e)=>{for(var r in e)vt(t,r,{get:e[r],enumerable:!0})},Ln=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of vn(e))!_n.call(t,n)&&n!==r&&vt(t,n,{get:()=>e[n],enumerable:!(i=wn(e,n))||i.enumerable});return t},kn=t=>Ln(vt({},"__esModule",{value:!0}),t),R=(t,e,r)=>new Promise((i,n)=>{var a=l=>{try{o(r.next(l))}catch(u){n(u)}},s=l=>{try{o(r.throw(l))}catch(u){n(u)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((r=r.apply(t,e)).next())}),_r={};zn(_r,{Compression:()=>Xr,EtagMismatch:()=>he,FetchSource:()=>Ur,FileAPISource:()=>aa,PMTiles:()=>Mt,Protocol:()=>Gn,ProtocolServer:()=>Qn,ResolvedValueCache:()=>oa,SharedPromiseCache:()=>Hr,TileType:()=>Vr,bytesToHeader:()=>jr,findTile:()=>Yr,getUint64:()=>K,leafletRasterLayer:()=>Jn,readVarint:()=>ke,tileIdToZxy:()=>ia,zxyToTileId:()=>Ir});Zr.exports=kn(_r);var q=Uint8Array,ze=Uint16Array,Sn=Int32Array,zr=new q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Lr=new q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fn=new q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kr=function(t,e){for(var r=new ze(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new Sn(r[30]),i=1;i<30;++i)for(var a=r[i];a<r[i+1];++a)n[a]=a-r[i]<<5|i;return{b:r,r:n}},Sr=kr(zr,2),Fr=Sr.b,Mn=Sr.r;Fr[28]=258,Mn[258]=28;var Mr=kr(Lr,0),Cn=Mr.b,qa=Mr.r,_t=new ze(32768);for(C=0;C<32768;++C)ae=(C&43690)>>1|(C&21845)<<1,ae=(ae&52428)>>2|(ae&13107)<<2,ae=(ae&61680)>>4|(ae&3855)<<4,_t[C]=((ae&65280)>>8|(ae&255)<<8)>>1;var ae,C,Oe=function(t,e,r){for(var i=t.length,n=0,a=new ze(e);n<i;++n)t[n]&&++a[t[n]-1];var s=new ze(e);for(n=1;n<e;++n)s[n]=s[n-1]+a[n-1]<<1;var o;if(r){o=new ze(1<<e);var l=15-e;for(n=0;n<i;++n)if(t[n])for(var u=n<<4|t[n],h=e-t[n],f=s[t[n]-1]++<<h,c=f|(1<<h)-1;f<=c;++f)o[_t[f]>>l]=u}else for(o=new ze(i),n=0;n<i;++n)t[n]&&(o[n]=_t[s[t[n]-1]++]>>15-t[n]);return o},Re=new q(288);for(C=0;C<144;++C)Re[C]=8;var C;for(C=144;C<256;++C)Re[C]=9;var C;for(C=256;C<280;++C)Re[C]=7;var C;for(C=280;C<288;++C)Re[C]=8;var C,Cr=new q(32);for(C=0;C<32;++C)Cr[C]=5;var C,Tn=Oe(Re,9,1),Pn=Oe(Cr,5,1),zt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Q=function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&r},Lt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Dn=function(t){return(t+7)/8|0},An=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var i=new q(r-e);return i.set(t.subarray(e,r)),i},Bn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],H=function(t,e,r){var i=new Error(e||Bn[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,H),!r)throw i;return i},kt=function(t,e,r,i){var n=t.length,a=i?i.length:0;if(!n||e.f&&!e.l)return r||new q(0);var s=!r||e.i!=2,o=e.i;r||(r=new q(n*3));var l=function(er){var tr=r.length;if(er>tr){var rr=new q(Math.max(tr*2,er));rr.set(r),r=rr}},u=e.f||0,h=e.p||0,f=e.b||0,c=e.l,g=e.d,w=e.m,v=e.n,d=n*8;do{if(!c){u=Q(t,h,1);var m=Q(t,h+1,3);if(h+=3,m)if(m==1)c=Tn,g=Pn,w=9,v=5;else if(m==2){var x=Q(t,h,31)+257,z=Q(t,h+10,15)+4,_=x+Q(t,h+5,31)+1;h+=14;for(var k=new q(_),S=new q(19),F=0;F<z;++F)S[Fn[F]]=Q(t,h+F*3,7);h+=z*3;for(var T=zt(S),O=(1<<T)-1,me=Oe(S,T,1),F=0;F<_;){var re=me[Q(t,h,O)];h+=re&15;var p=re>>4;if(p<16)k[F++]=p;else{var N=0,G=0;for(p==16?(G=3+Q(t,h,3),h+=2,N=k[F-1]):p==17?(G=3+Q(t,h,7),h+=3):p==18&&(G=11+Q(t,h,127),h+=7);G--;)k[F++]=N}}var Qe=k.subarray(0,x),I=k.subarray(x);w=zt(Qe),v=zt(I),c=Oe(Qe,w,1),g=Oe(I,v,1)}else H(1);else{var p=Dn(h)+4,b=t[p-4]|t[p-3]<<8,y=p+b;if(y>n){o&&H(0);break}s&&l(f+b),r.set(t.subarray(p,y),f),e.b=f+=b,e.p=h=y*8,e.f=u;continue}if(h>d){o&&H(0);break}}s&&l(f+131072);for(var pe=(1<<w)-1,$=(1<<v)-1,ct=h;;ct=h){var N=c[Lt(t,h)&pe],xe=N>>4;if(h+=N&15,h>d){o&&H(0);break}if(N||H(2),xe<256)r[f++]=xe;else if(xe==256){ct=h,c=null;break}else{var Gt=xe-254;if(xe>264){var F=xe-257,Ae=zr[F];Gt=Q(t,h,(1<<Ae)-1)+Fr[F],h+=Ae}var mt=g[Lt(t,h)&$],pt=mt>>4;mt||H(3),h+=mt&15;var I=Cn[pt];if(pt>3){var Ae=Lr[pt];I+=Lt(t,h)&(1<<Ae)-1,h+=Ae}if(h>d){o&&H(0);break}s&&l(f+131072);var yt=f+Gt;if(f<I){var Qt=a-I,Ei=Math.min(I,yt);for(Qt+f<0&&H(3);f<Ei;++f)r[f]=i[Qt+f]}for(;f<yt;f+=4)r[f]=r[f-I],r[f+1]=r[f+1-I],r[f+2]=r[f+2-I],r[f+3]=r[f+3-I];f=yt}}e.l=c,e.p=ct,e.b=f,e.f=u,c&&(u=1,e.m=w,e.d=g,e.n=v)}while(!u);return f==r.length?r:An(r,0,f)},On=new q(0),Rn=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&H(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[r++]);return r+(e&2)},En=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},In=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&H(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&H(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Xn(t,e){return kt(t,{i:2},e&&e.out,e&&e.dictionary)}function Vn(t,e){var r=Rn(t);return r+8>t.length&&H(6,"invalid gzip data"),kt(t.subarray(r,-8),{i:2},e&&e.out||new q(En(t)),e&&e.dictionary)}function Yn(t,e){return kt(t.subarray(In(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function St(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Vn(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Xn(t,e):Yn(t,e)}var Un=typeof TextDecoder!="undefined"&&new TextDecoder,jn=0;try{Un.decode(On,{stream:!0}),jn=1}catch(t){}var Tr=(t,e)=>t*Math.pow(2,e),Ee=(t,e)=>Math.floor(t/Math.pow(2,e)),it=(t,e)=>Tr(t.getUint16(e+1,!0),8)+t.getUint8(e),Pr=(t,e)=>Tr(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),Nn=(t,e,r,i,n)=>{if(t!=i.getUint8(n))return t-i.getUint8(n);let a=it(i,n+1);if(e!=a)return e-a;let s=it(i,n+4);return r!=s?r-s:0},$n=(t,e,r,i)=>{let n=Ar(t,e|128,r,i);return n?{z:e,x:r,y:i,offset:n[0],length:n[1],is_dir:!0}:null},Dr=(t,e,r,i)=>{let n=Ar(t,e,r,i);return n?{z:e,x:r,y:i,offset:n[0],length:n[1],is_dir:!1}:null},Ar=(t,e,r,i)=>{let n=0,a=t.byteLength/17-1;for(;n<=a;){let s=a+n>>1,o=Nn(e,r,i,t,s*17);if(o>0)n=s+1;else if(o<0)a=s-1;else return[Pr(t,s*17+7),t.getUint32(s*17+13,!0)]}return null},qn=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Br=(t,e)=>{let r=t.getUint8(e*17);return{z:r&127,x:it(t,e*17+1),y:it(t,e*17+4),offset:Pr(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7==1}},Or=t=>{let e=[],r=new DataView(t);for(let i=0;i<r.byteLength/17;i++)e.push(Br(r,i));return Hn(e)},Hn=t=>{t.sort(qn);let e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let i=0;i<t.length;i++){let n=t[i],a=n.z;n.is_dir&&(a=a|128),r[i*17]=a,r[i*17+1]=n.x&255,r[i*17+2]=n.x>>8&255,r[i*17+3]=n.x>>16&255,r[i*17+4]=n.y&255,r[i*17+5]=n.y>>8&255,r[i*17+6]=n.y>>16&255,r[i*17+7]=n.offset&255,r[i*17+8]=Ee(n.offset,8)&255,r[i*17+9]=Ee(n.offset,16)&255,r[i*17+10]=Ee(n.offset,24)&255,r[i*17+11]=Ee(n.offset,32)&255,r[i*17+12]=Ee(n.offset,48)&255,r[i*17+13]=n.length&255,r[i*17+14]=n.length>>8&255,r[i*17+15]=n.length>>16&255,r[i*17+16]=n.length>>24&255}return e},Zn=(t,e)=>{if(t.byteLength<17)return null;let r=t.byteLength/17,i=Br(t,r-1);if(i.is_dir){let n=i.z,a=e.z-n,s=Math.trunc(e.x/(1<<a)),o=Math.trunc(e.y/(1<<a));return{z:n,x:s,y:o}}return null};function Wn(t){return R(this,null,function*(){let e=yield t.getBytes(0,512e3),r=new DataView(e.data),i=r.getUint32(4,!0),n=r.getUint16(8,!0),a=new TextDecoder("utf-8"),s=JSON.parse(a.decode(new DataView(e.data,10,i))),o=0;s.compression==="gzip"&&(o=2);let l=0;"minzoom"in s&&(l=+s.minzoom);let u=0;"maxzoom"in s&&(u=+s.maxzoom);let h=0,f=0,c=0,g=-180,w=-85,v=180,d=85;if(s.bounds){let p=s.bounds.split(",");g=+p[0],w=+p[1],v=+p[2],d=+p[3]}if(s.center){let p=s.center.split(",");h=+p[0],f=+p[1],c=+p[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+i,rootDirectoryLength:n*17,jsonMetadataOffset:10,jsonMetadataLength:i,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:o,tileType:1,minZoom:l,maxZoom:u,minLon:g,minLat:w,maxLon:v,maxLat:d,centerZoom:c,centerLon:h,centerLat:f,etag:e.etag}})}function Kn(t,e,r,i,n,a,s){return R(this,null,function*(){let o=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(o=Or(o));let l=Dr(new DataView(o),i,n,a);if(l){let f=(yield e.getBytes(l.offset,l.length,s)).data,c=new DataView(f);return c.getUint8(0)==31&&c.getUint8(1)==139&&(f=St(new Uint8Array(f))),{data:f}}let u=Zn(new DataView(o),{z:i,x:n,y:a});if(u){let h=$n(new DataView(o),u.z,u.x,u.y);if(h){let f=yield r.getArrayBuffer(e,h.offset,h.length,t);t.specVersion===1&&(f=Or(f));let c=Dr(new DataView(f),i,n,a);if(c){let w=(yield e.getBytes(c.offset,c.length,s)).data,v=new DataView(w);return v.getUint8(0)==31&&v.getUint8(1)==139&&(w=St(new Uint8Array(w))),{data:w}}}}})}var Rr={getHeader:Wn,getZxy:Kn},Jn=(t,e)=>{let r=!1,i="",n=L.GridLayer.extend({createTile:function(a,s){let o=document.createElement("img"),l=new AbortController,u=l.signal;return o.cancel=()=>{l.abort()},r||(t.getHeader().then(h=>{h.tileType==1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):h.tileType==2?i="image/png":h.tileType==3?i="image/jpeg":h.tileType==4?i="image/webp":h.tileType==5&&(i="image/avif")}),r=!0),t.getZxy(a.z,a.x,a.y,u).then(h=>{if(h){let f=new Blob([h.data],{type:i}),c=window.URL.createObjectURL(f);o.src=c,o.cancel=null,s(null,o)}}).catch(h=>{if(h.name!=="AbortError")throw h}),o},_removeTile:function(a){let s=this._tiles[a];!s||(s.el.cancel&&s.el.cancel(),s.el.width=0,s.el.height=0,s.el.deleted=!0,L.DomUtil.remove(s.el),delete this._tiles[a],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(a)}))}});return new n(e)},Gn=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){let r=t.url.substr(10),i=this.tiles.get(r);return i||(i=new Mt(r),this.tiles.set(r,i)),i.getHeader().then(n=>{let a={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:n.minZoom,maxzoom:n.maxZoom,bounds:[n.minLon,n.minLat,n.maxLon,n.maxLat]};e(null,a,null,null)}).catch(n=>{e(n,null,null,null)}),{cancel:()=>{}}}else{let r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),i=t.url.match(r);if(!i)throw new Error("Invalid PMTiles protocol URL");let n=i[1],a=this.tiles.get(n);a||(a=new Mt(n,void 0,void 0,t.headers),this.tiles.set(n,a));let s=i[2],o=i[3],l=i[4],u=new AbortController,h=u.signal,f=()=>{u.abort()};return a.getHeader().then(c=>{a.getZxy(+s,+o,+l,h).then(g=>{g?e(null,new Uint8Array(g.data),g.cacheControl,g.expires):c.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(g=>{g.name!=="AbortError"&&e(g,null,null,null)})}),{cancel:f}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}},Qn=class{constructor(){this.tile=(t,e)=>{let r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),i=t.url.match(r);if(!i)throw new Error("Invalid PMTiles protocol URL");let n=i[1],a,s,o=new AbortController,l=o.signal,u=()=>{o.abort()};try{let g=new URL(n);a=g.hostname,s=g.pathname.split("/").filter(w=>w!=="")}catch(g){return console.error("Invalid URL:",g),{cancel:u}}let h=i[2],f=i[3],c=i[4];return fetch(`https://${a}/header/${s[0]}/${s[1]}`,{headers:t.headers}).then(g=>{g.json().then(w=>{fetch(`https://${a}/tile/${s[0]}/${s[1]}/${h}/${f}/${c}`,{headers:t.headers}).then(v=>{v?v.arrayBuffer().then(d=>{e(null,new Uint8Array(d),null,null)}):w.tile_type==1?e(null,new Uint8Array,null,null):e(null,null,null,null)})})}).catch(g=>{g.name!=="AbortError"&&e(g,null,null,null)}),{cancel:u}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function Le(t,e){return(e>>>0)*4294967296+(t>>>0)}function ea(t,e){let r=e.buf,i,n;if(n=r[e.pos++],i=(n&112)>>4,n<128||(n=r[e.pos++],i|=(n&127)<<3,n<128)||(n=r[e.pos++],i|=(n&127)<<10,n<128)||(n=r[e.pos++],i|=(n&127)<<17,n<128)||(n=r[e.pos++],i|=(n&127)<<24,n<128)||(n=r[e.pos++],i|=(n&1)<<31,n<128))return Le(t,i);throw new Error("Expected varint not more than 10 bytes")}function ke(t){let e=t.buf,r,i;return i=e[t.pos++],r=i&127,i<128||(i=e[t.pos++],r|=(i&127)<<7,i<128)||(i=e[t.pos++],r|=(i&127)<<14,i<128)||(i=e[t.pos++],r|=(i&127)<<21,i<128)?r:(i=e[t.pos],r|=(i&15)<<28,ea(r,t))}function Er(t,e,r,i){if(i==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);let n=e[0];e[0]=e[1],e[1]=n}}function ta(t,e){let r=Math.pow(2,t),i=e,n=e,a=e,s=[0,0],o=1;for(;o<r;)i=1&a/2,n=1&(a^i),Er(o,s,i,n),s[0]+=o*i,s[1]+=o*n,a=a/4,o*=2;return[t,s[0],s[1]]}var ra=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,1501199875790165];function Ir(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");let i=ra[t],n=Math.pow(2,t),a=0,s=0,o=0,l=[e,r],u=n/2;for(;u>0;)a=(l[0]&u)>0?1:0,s=(l[1]&u)>0?1:0,o+=u*u*(3*a^s),Er(u,l,a,s),u=u/2;return i+o}function ia(t){let e=0,r=0;for(let i=0;i<27;i++){let n=(1<<i)*(1<<i);if(e+n>t)return ta(i,t-e);e+=n}throw Error("Tile zoom level exceeds max safe number limit (26)")}var Xr=(t=>(t[t.Unknown=0]="Unknown",t[t.None=1]="None",t[t.Gzip=2]="Gzip",t[t.Brotli=3]="Brotli",t[t.Zstd=4]="Zstd",t))(Xr||{});function Ft(t,e){return R(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream=="undefined")return St(new Uint8Array(t));{let i=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(i).arrayBuffer()}}else throw Error("Compression method not supported")})}var Vr=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t))(Vr||{}),na=127;function Yr(t,e){let r=0,i=t.length-1;for(;r<=i;){let n=i+r>>1,a=e-t[n].tileId;if(a>0)r=n+1;else if(a<0)i=n-1;else return t[n]}return i>=0&&(t[i].runLength===0||e-t[i].tileId<t[i].runLength)?t[i]:null}var aa=class{constructor(t){this.file=t}getKey(){return this.file.name}getBytes(t,e){return R(this,null,function*(){return{data:yield this.file.slice(t,t+e).arrayBuffer()}})}},Ur=class{constructor(t,e=new Headers){this.url=t,this.customHeaders=e}getKey(){return this.url}setHeaders(t){this.customHeaders=t}getBytes(t,e,r){return R(this,null,function*(){let i;r||(i=new AbortController,r=i.signal);let n=new Headers(this.customHeaders);n.set("Range","bytes="+t+"-"+(t+e-1));let a=yield fetch(this.url,{signal:r,headers:n});if(a.status===416&&t===0){let l=a.headers.get("Content-Range");if(!l||!l.startsWith("bytes */"))throw Error("Missing content-length on 416 response");let u=+l.substr(8);a=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(u-1)}})}if(a.status>=300)throw Error("Bad response code: "+a.status);let s=a.headers.get("Content-Length");if(a.status===200&&(!s||+s>e))throw i&&i.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield a.arrayBuffer(),etag:a.headers.get("ETag")||void 0,cacheControl:a.headers.get("Cache-Control")||void 0,expires:a.headers.get("Expires")||void 0}})}};function K(t,e){let r=t.getUint32(e+4,!0),i=t.getUint32(e+0,!0);return r*Math.pow(2,32)+i}function jr(t,e){let r=new DataView(t),i=r.getUint8(7);if(i>3)throw Error(`Archive is spec version ${i} but this library supports up to spec version 3`);return{specVersion:i,rootDirectoryOffset:K(r,8),rootDirectoryLength:K(r,16),jsonMetadataOffset:K(r,24),jsonMetadataLength:K(r,32),leafDirectoryOffset:K(r,40),leafDirectoryLength:K(r,48),tileDataOffset:K(r,56),tileDataLength:K(r,64),numAddressedTiles:K(r,72),numTileEntries:K(r,80),numTileContents:K(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Nr(t){let e={buf:new Uint8Array(t),pos:0},r=ke(e),i=[],n=0;for(let a=0;a<r;a++){let s=ke(e);i.push({tileId:n+s,offset:0,length:0,runLength:1}),n+=s}for(let a=0;a<r;a++)i[a].runLength=ke(e);for(let a=0;a<r;a++)i[a].length=ke(e);for(let a=0;a<r;a++){let s=ke(e);s===0&&a>0?i[a].offset=i[a-1].offset+i[a-1].length:i[a].offset=s-1}return i}function sa(t){let e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var he=class extends Error{};function $r(t,e,r,i){return R(this,null,function*(){let n=yield t.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(sa(n.data)<3)return[yield Rr.getHeader(t)];let s=n.data.slice(0,na),o=n.etag;i&&n.etag!=i&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),o=void 0);let l=jr(s,o);if(r){let u=n.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),h=t.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,f=Nr(yield e(u,l.internalCompression));return[l,[h,f.length,f]]}return[l,void 0]})}function qr(t,e,r,i,n){return R(this,null,function*(){let a=yield t.getBytes(r,i);if(n.etag&&n.etag!==a.etag)throw new he(a.etag);let s=yield e(a.data,n.internalCompression),o=Nr(s);if(o.length===0)throw new Error("Empty directory is invalid");return o})}var oa=class{constructor(t=100,e=!0,r=Ft){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return R(this,null,function*(){let r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,this.cache.get(r).data;let i=yield $r(t,this.decompress,this.prefetch,e);return i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:i[1][2]}),this.cache.set(r,{lastUsed:this.counter++,data:i[0]}),this.prune(),i[0]})}getDirectory(t,e,r,i){return R(this,null,function*(){let n=t.getKey()+"|"+(i.etag||"")+"|"+e+"|"+r;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,this.cache.get(n).data;let a=yield qr(t,this.decompress,e,r,i);return this.cache.set(n,{lastUsed:this.counter++,data:a}),this.prune(),a})}getArrayBuffer(t,e,r,i){return R(this,null,function*(){let n=t.getKey()+"|"+(i.etag||"")+"|"+e+"|"+r;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;let a=yield t.getBytes(e,r);if(i.etag&&i.etag!==a.etag)throw new he(i.etag);return this.cache.set(n,{lastUsed:this.counter++,data:a.data}),this.prune(),a.data})}prune(){if(this.cache.size>this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,i)=>{r.lastUsed<t&&(t=r.lastUsed,e=i)}),e&&this.cache.delete(e)}}invalidate(t,e){return R(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Hr=class{constructor(t=100,e=!0,r=Ft){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return R(this,null,function*(){let r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;let i=new Promise((n,a)=>{$r(t,this.decompress,this.prefetch,e).then(s=>{s[1]&&this.cache.set(s[1][0],{lastUsed:this.counter++,data:Promise.resolve(s[1][2])}),n(s[0]),this.prune()}).catch(s=>{a(s)})});return this.cache.set(r,{lastUsed:this.counter++,data:i}),i})}getDirectory(t,e,r,i){return R(this,null,function*(){let n=t.getKey()+"|"+(i.etag||"")+"|"+e+"|"+r;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;let a=new Promise((s,o)=>{qr(t,this.decompress,e,r,i).then(l=>{s(l),this.prune()}).catch(l=>{o(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:a}),a})}getArrayBuffer(t,e,r,i){return R(this,null,function*(){let n=t.getKey()+"|"+(i.etag||"")+"|"+e+"|"+r;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;let a=new Promise((s,o)=>{t.getBytes(e,r).then(l=>{if(i.etag&&i.etag!==l.etag)throw new he(l.etag);s(l.data),this.cache.has(n),this.prune()}).catch(l=>{o(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,i)=>{r.lastUsed<t&&(t=r.lastUsed,e=i)}),e&&this.cache.delete(e)}}invalidate(t,e){return R(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Mt=class{constructor(t,e,r,i){typeof t=="string"?this.source=new Ur(t,i):this.source=t,r?this.decompress=r:this.decompress=Ft,e?this.cache=e:this.cache=new Hr,i?this.customHeaders=i:this.customHeaders=void 0}getHeader(){return R(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,i){return R(this,null,function*(){let n=Ir(t,e,r),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return Rr.getZxy(a,this.source,this.cache,t,e,r,i);if(t<a.minZoom||t>a.maxZoom)return;let s=a.rootDirectoryOffset,o=a.rootDirectoryLength;for(let l=0;l<=3;l++){let u=yield this.cache.getDirectory(this.source,s,o,a),h=Yr(u,n);if(h)if(h.runLength>0){let f=yield this.source.getBytes(a.tileDataOffset+h.offset,h.length,i);if(a.etag&&a.etag!==f.etag)throw new he(f.etag);return{data:yield this.decompress(f.data,a.tileCompression),cacheControl:f.cacheControl,expires:f.expires}}else s=a.leafDirectoryOffset+h.offset,o=h.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,i){return R(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,i)}catch(n){if(n instanceof he)return this.cache.invalidate(this.source,n.message),yield this.getZxyAttempt(t,e,r,i);throw n}})}getMetadataAttempt(){return R(this,null,function*(){let t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new he(e.etag);let r=yield this.decompress(e.data,t.internalCompression),i=new TextDecoder("utf-8");return JSON.parse(i.decode(r))})}getMetadata(){return R(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof he)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}}});var si=W((At,Bt)=>{(function(t,e){typeof At=="object"&&typeof Bt!="undefined"?Bt.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self).RBush=e()})(At,function(){"use strict";function t(d,m,p,b,y){(function x(z,_,k,S,F){for(;S>k;){if(S-k>600){var T=S-k+1,O=_-k+1,me=Math.log(T),re=.5*Math.exp(2*me/3),N=.5*Math.sqrt(me*re*(T-re)/T)*(O-T/2<0?-1:1),G=Math.max(k,Math.floor(_-O*re/T+N)),Qe=Math.min(S,Math.floor(_+(T-O)*re/T+N));x(z,_,G,Qe,F)}var I=z[_],pe=k,$=S;for(e(z,k,_),F(z[S],I)>0&&e(z,k,S);pe<$;){for(e(z,pe,$),pe++,$--;F(z[pe],I)<0;)pe++;for(;F(z[$],I)>0;)$--}F(z[k],I)===0?e(z,k,$):e(z,++$,S),$<=_&&(k=$+1),_<=$&&(S=$-1)}})(d,m,p||0,b||d.length-1,y||r)}function e(d,m,p){var b=d[m];d[m]=d[p],d[p]=b}function r(d,m){return d<m?-1:d>m?1:0}var i=function(d){d===void 0&&(d=9),this._maxEntries=Math.max(4,d),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(d,m,p){if(!p)return m.indexOf(d);for(var b=0;b<m.length;b++)if(p(d,m[b]))return b;return-1}function a(d,m){s(d,0,d.children.length,m,d)}function s(d,m,p,b,y){y||(y=w(null)),y.minX=1/0,y.minY=1/0,y.maxX=-1/0,y.maxY=-1/0;for(var x=m;x<p;x++){var z=d.children[x];o(y,d.leaf?b(z):z)}return y}function o(d,m){return d.minX=Math.min(d.minX,m.minX),d.minY=Math.min(d.minY,m.minY),d.maxX=Math.max(d.maxX,m.maxX),d.maxY=Math.max(d.maxY,m.maxY),d}function l(d,m){return d.minX-m.minX}function u(d,m){return d.minY-m.minY}function h(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function f(d){return d.maxX-d.minX+(d.maxY-d.minY)}function c(d,m){return d.minX<=m.minX&&d.minY<=m.minY&&m.maxX<=d.maxX&&m.maxY<=d.maxY}function g(d,m){return m.minX<=d.maxX&&m.minY<=d.maxY&&m.maxX>=d.minX&&m.maxY>=d.minY}function w(d){return{children:d,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(d,m,p,b,y){for(var x=[m,p];x.length;)if(!((p=x.pop())-(m=x.pop())<=b)){var z=m+Math.ceil((p-m)/b/2)*b;t(d,z,m,p,y),x.push(m,z,z,p)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(d){var m=this.data,p=[];if(!g(d,m))return p;for(var b=this.toBBox,y=[];m;){for(var x=0;x<m.children.length;x++){var z=m.children[x],_=m.leaf?b(z):z;g(d,_)&&(m.leaf?p.push(z):c(d,_)?this._all(z,p):y.push(z))}m=y.pop()}return p},i.prototype.collides=function(d){var m=this.data;if(!g(d,m))return!1;for(var p=[];m;){for(var b=0;b<m.children.length;b++){var y=m.children[b],x=m.leaf?this.toBBox(y):y;if(g(d,x)){if(m.leaf||c(d,x))return!0;p.push(y)}}m=p.pop()}return!1},i.prototype.load=function(d){if(!d||!d.length)return this;if(d.length<this._minEntries){for(var m=0;m<d.length;m++)this.insert(d[m]);return this}var p=this._build(d.slice(),0,d.length-1,0);if(this.data.children.length)if(this.data.height===p.height)this._splitRoot(this.data,p);else{if(this.data.height<p.height){var b=this.data;this.data=p,p=b}this._insert(p,this.data.height-p.height-1,!0)}else this.data=p;return this},i.prototype.insert=function(d){return d&&this._insert(d,this.data.height-1),this},i.prototype.clear=function(){return this.data=w([]),this},i.prototype.remove=function(d,m){if(!d)return this;for(var p,b,y,x=this.data,z=this.toBBox(d),_=[],k=[];x||_.length;){if(x||(x=_.pop(),b=_[_.length-1],p=k.pop(),y=!0),x.leaf){var S=n(d,x.children,m);if(S!==-1)return x.children.splice(S,1),_.push(x),this._condense(_),this}y||x.leaf||!c(x,z)?b?(p++,x=b.children[p],y=!1):x=null:(_.push(x),k.push(p),p=0,b=x,x=x.children[0])}return this},i.prototype.toBBox=function(d){return d},i.prototype.compareMinX=function(d,m){return d.minX-m.minX},i.prototype.compareMinY=function(d,m){return d.minY-m.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(d){return this.data=d,this},i.prototype._all=function(d,m){for(var p=[];d;)d.leaf?m.push.apply(m,d.children):p.push.apply(p,d.children),d=p.pop();return m},i.prototype._build=function(d,m,p,b){var y,x=p-m+1,z=this._maxEntries;if(x<=z)return a(y=w(d.slice(m,p+1)),this.toBBox),y;b||(b=Math.ceil(Math.log(x)/Math.log(z)),z=Math.ceil(x/Math.pow(z,b-1))),(y=w([])).leaf=!1,y.height=b;var _=Math.ceil(x/z),k=_*Math.ceil(Math.sqrt(z));v(d,m,p,k,this.compareMinX);for(var S=m;S<=p;S+=k){var F=Math.min(S+k-1,p);v(d,S,F,_,this.compareMinY);for(var T=S;T<=F;T+=_){var O=Math.min(T+_-1,F);y.children.push(this._build(d,T,O,b-1))}}return a(y,this.toBBox),y},i.prototype._chooseSubtree=function(d,m,p,b){for(;b.push(m),!m.leaf&&b.length-1!==p;){for(var y=1/0,x=1/0,z=void 0,_=0;_<m.children.length;_++){var k=m.children[_],S=h(k),F=(T=d,O=k,(Math.max(O.maxX,T.maxX)-Math.min(O.minX,T.minX))*(Math.max(O.maxY,T.maxY)-Math.min(O.minY,T.minY))-S);F<x?(x=F,y=S<y?S:y,z=k):F===x&&S<y&&(y=S,z=k)}m=z||m.children[0]}var T,O;return m},i.prototype._insert=function(d,m,p){var b=p?d:this.toBBox(d),y=[],x=this._chooseSubtree(b,this.data,m,y);for(x.children.push(d),o(x,b);m>=0&&y[m].children.length>this._maxEntries;)this._split(y,m),m--;this._adjustParentBBoxes(b,y,m)},i.prototype._split=function(d,m){var p=d[m],b=p.children.length,y=this._minEntries;this._chooseSplitAxis(p,y,b);var x=this._chooseSplitIndex(p,y,b),z=w(p.children.splice(x,p.children.length-x));z.height=p.height,z.leaf=p.leaf,a(p,this.toBBox),a(z,this.toBBox),m?d[m-1].children.push(z):this._splitRoot(p,z)},i.prototype._splitRoot=function(d,m){this.data=w([d,m]),this.data.height=d.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(d,m,p){for(var b,y,x,z,_,k,S,F=1/0,T=1/0,O=m;O<=p-m;O++){var me=s(d,0,O,this.toBBox),re=s(d,O,p,this.toBBox),N=(y=me,x=re,z=void 0,_=void 0,k=void 0,S=void 0,z=Math.max(y.minX,x.minX),_=Math.max(y.minY,x.minY),k=Math.min(y.maxX,x.maxX),S=Math.min(y.maxY,x.maxY),Math.max(0,k-z)*Math.max(0,S-_)),G=h(me)+h(re);N<F?(F=N,b=O,T=G<T?G:T):N===F&&G<T&&(T=G,b=O)}return b||p-m},i.prototype._chooseSplitAxis=function(d,m,p){var b=d.leaf?this.compareMinX:l,y=d.leaf?this.compareMinY:u;this._allDistMargin(d,m,p,b)<this._allDistMargin(d,m,p,y)&&d.children.sort(b)},i.prototype._allDistMargin=function(d,m,p,b){d.children.sort(b);for(var y=this.toBBox,x=s(d,0,m,y),z=s(d,p-m,p,y),_=f(x)+f(z),k=m;k<p-m;k++){var S=d.children[k];o(x,d.leaf?y(S):S),_+=f(x)}for(var F=p-m-1;F>=m;F--){var T=d.children[F];o(z,d.leaf?y(T):T),_+=f(z)}return _},i.prototype._adjustParentBBoxes=function(d,m,p){for(var b=p;b>=0;b--)o(m[b],d)},i.prototype._condense=function(d){for(var m=d.length-1,p=void 0;m>=0;m--)d[m].children.length===0?m>0?(p=d[m-1].children).splice(p.indexOf(d[m]),1):this.clear():a(d[m],this.toBBox)},i})});var ci=W(()=>{});var mi=W((Et,It)=>{(function(t,e){typeof Et=="object"&&typeof It!="undefined"?It.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self,t.TinyQueue=e())})(Et,function(){"use strict";var t=function(i,n){if(i===void 0&&(i=[]),n===void 0&&(n=e),this.data=i,this.length=this.data.length,this.compare=n,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};t.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(this.length!==0){var i=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),i}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(i){for(var n=this,a=n.data,s=n.compare,o=a[i];i>0;){var l=i-1>>1,u=a[l];if(s(o,u)>=0)break;a[i]=u,i=l}a[i]=o},t.prototype._down=function(i){for(var n=this,a=n.data,s=n.compare,o=this.length>>1,l=a[i];i<o;){var u=(i<<1)+1,h=a[u],f=u+1;if(f<this.length&&s(a[f],h)<0&&(u=f,h=a[f]),s(h,l)>=0)break;a[i]=h,i=u}a[i]=l};function e(r,i){return r<i?-1:r>i?1:0}return t})});var yi=W((cs,Xt)=>{"use strict";var lt=mi();lt.default&&(lt=lt.default);Xt.exports=pi;Xt.exports.default=pi;function pi(t,e,r){e=e||1;for(var i,n,a,s,o=0;o<t[0].length;o++){var l=t[0][o];(!o||l[0]<i)&&(i=l[0]),(!o||l[1]<n)&&(n=l[1]),(!o||l[0]>a)&&(a=l[0]),(!o||l[1]>s)&&(s=l[1])}var u=a-i,h=s-n,f=Math.min(u,h),c=f/2;if(f===0){var g=[i,n];return g.distance=0,g}for(var w=new lt(void 0,ba),v=i;v<a;v+=f)for(var d=n;d<s;d+=f)w.push(new fe(v+c,d+c,c,t));var m=va(t),p=new fe(i+u/2,n+h/2,0,t);p.d>m.d&&(m=p);for(var b=w.length;w.length;){var y=w.pop();y.d>m.d&&(m=y,r&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,b)),!(y.max-m.d<=e)&&(c=y.h/2,w.push(new fe(y.x-c,y.y-c,c,t)),w.push(new fe(y.x+c,y.y-c,c,t)),w.push(new fe(y.x-c,y.y+c,c,t)),w.push(new fe(y.x+c,y.y+c,c,t)),b+=4)}r&&(console.log("num probes: "+b),console.log("best distance: "+m.d));var x=[m.x,m.y];return x.distance=m.d,x}function ba(t,e){return e.max-t.max}function fe(t,e,r,i){this.x=t,this.y=e,this.h=r,this.d=wa(t,e,i),this.max=this.d+this.h*Math.SQRT2}function wa(t,e,r){for(var i=!1,n=1/0,a=0;a<r.length;a++)for(var s=r[a],o=0,l=s.length,u=l-1;o<l;u=o++){var h=s[o],f=s[u];h[1]>e!=f[1]>e&&t<(f[0]-h[0])*(e-h[1])/(f[1]-h[1])+h[0]&&(i=!i),n=Math.min(n,_a(t,e,h,f))}return n===0?0:(i?1:-1)*Math.sqrt(n)}function va(t){for(var e=0,r=0,i=0,n=t[0],a=0,s=n.length,o=s-1;a<s;o=a++){var l=n[a],u=n[o],h=l[0]*u[1]-u[0]*l[1];r+=(l[0]+u[0])*h,i+=(l[1]+u[1])*h,e+=h*3}return e===0?new fe(n[0][0],n[0][1],0,t):new fe(r/e,i/e,0,t)}function _a(t,e,r,i){var n=r[0],a=r[1],s=i[0]-n,o=i[1]-a;if(s!==0||o!==0){var l=((t-n)*s+(e-a)*o)/(s*s+o*o);l>1?(n=i[0],a=i[1]):l>0&&(n+=s*l,a+=o*l)}return s=t-n,o=e-a,s*s+o*o}});var Ea={};ji(Ea,{CenteredSymbolizer:()=>Nt,CenteredTextSymbolizer:()=>U,CircleSymbolizer:()=>te,FlexSymbolizer:()=>We,Font:()=>Zt,GeomType:()=>ee,GroupSymbolizer:()=>ge,IconSymbolizer:()=>ki,Index:()=>Ot,Justify:()=>V,Labeler:()=>je,Labelers:()=>Ne,LineLabelPlacement:()=>Te,LineLabelSymbolizer:()=>ce,LineSymbolizer:()=>P,OffsetSymbolizer:()=>$t,OffsetTextSymbolizer:()=>oe,PMTiles:()=>Ri.PMTiles,Padding:()=>Fi,PmtilesSource:()=>Ie,PolygonLabelSymbolizer:()=>le,PolygonSymbolizer:()=>A,Sheet:()=>Oi,ShieldSymbolizer:()=>ut,Static:()=>Di,TextPlacements:()=>D,TextSymbolizer:()=>Ke,TileCache:()=>ot,Toner:()=>Ra,View:()=>Dt,ZxySource:()=>nt,arr:()=>de,covering:()=>ui,createPattern:()=>jt,cubicBezier:()=>Fa,dark:()=>Me,exp:()=>j,filterFn:()=>Ge,getFont:()=>Jt,getZoom:()=>qt,isCCW:()=>ti,isInRing:()=>Pt,json_style:()=>Oa,labelRules:()=>De,leafletLayer:()=>Aa,light:()=>Fe,linear:()=>Sa,numberFn:()=>dt,numberOrFn:()=>Wt,paintRules:()=>Pe,painter:()=>Ue,pointInPolygon:()=>ri,pointMinDistToLines:()=>ni,pointMinDistToPoints:()=>ii,sourcesToViews:()=>Ye,step:()=>ka,toIndex:()=>se,transformGeom:()=>Xe,widthFn:()=>Kt,wrap:()=>Ve});var ue=Y(ie());var ye=Y(ie());var Se=Y(ie()),Wr=Y(mr()),Kr=Y(vr()),Jr=Y(Ct()),ee;(function(i){i[i.Point=1]="Point",i[i.Line=2]="Line",i[i.Polygon=3]="Polygon"})(ee||(ee={}));function se(t){return t.x+":"+t.y+":"+t.z}var la=(t,e,r)=>{t.pos=e;for(var i=t.readVarint()+t.pos,n=1,a=0,s=0,o=0,l=1/0,u=-1/0,h=1/0,f=-1/0,c=[],g=[];t.pos<i;){if(a<=0){var w=t.readVarint();n=w&7,a=w>>3}if(a--,n===1||n===2)s+=t.readSVarint()*r,o+=t.readSVarint()*r,s<l&&(l=s),s>u&&(u=s),o<h&&(h=o),o>f&&(f=o),n===1&&(g.length>0&&c.push(g),g=[]),g.push(new Se.default(s,o));else if(n===7)g&&g.push(g[0].clone());else throw new Error("unknown command "+n)}return g&&c.push(g),{geom:c,bbox:{minX:l,minY:h,maxX:u,maxY:f}}};function Gr(t,e){let r=new Wr.VectorTile(new Kr.default(t)),i=new Map;for(let[n,a]of Object.entries(r.layers)){let s=[],o=a;for(let l=0;l<o.length;l++){let u=la(o.feature(l)._pbf,o.feature(l)._geometry,e/o.extent),h=0;for(let f of u.geom)h+=f.length;s.push({id:o.feature(l).id,geomType:o.feature(l).type,geom:u.geom,numVertices:h,bbox:u.bbox,props:o.feature(l).properties})}i.set(n,s)}return i}var Ie=class{constructor(e,r,i){typeof e=="string"?this.p=new Jr.PMTiles(e,void 0,void 0,i):this.p=e,this.controllers=[],this.shouldCancelZooms=r,this.headers=i}get(e,r){return E(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(s=>s[0]!=e.z?(s[1].abort(),!1):!0));let i=new AbortController;this.controllers.push([e.z,i]);let n=i.signal,a=yield this.p.getZxy(e.z,e.x,e.y,n);return a?Gr(a.data,r):new Map})}},nt=class{constructor(e,r,i){this.url=e,this.controllers=[],this.shouldCancelZooms=r,this.headers=i}get(e,r){return E(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(s=>s[0]!=e.z?(s[1].abort(),!1):!0));let i=this.url.replace("{z}",e.z.toString()).replace("{x}",e.x.toString()).replace("{y}",e.y.toString()),n=new AbortController;this.controllers.push([e.z,n]);let a=n.signal;return new Promise((s,o)=>{fetch(i,{signal:a,headers:this.headers}).then(l=>l.arrayBuffer()).then(l=>{let u=Gr(l,r);s(u)}).catch(l=>{o(l)})})})}},Tt=6378137,Qr=85.0511287798,at=Tt*Math.PI,ua=t=>{let e=Math.PI/180,r=Math.max(Math.min(Qr,t[0]),-Qr),i=Math.sin(r*e);return new Se.default(Tt*t[1]*e,Tt*Math.log((1+i)/(1-i))/2)};function ei(t){return t*t}function st(t,e){return ei(t.x-e.x)+ei(t.y-e.y)}function ha(t,e,r){var i=st(e,r);if(i===0)return st(t,e);var n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return n=Math.max(0,Math.min(1,n)),st(t,new Se.default(e.x+n*(r.x-e.x),e.y+n*(r.y-e.y)))}function Pt(t,e){for(var r=!1,i=0,n=e.length-1;i<e.length;n=i++){var a=e[i].x,s=e[i].y,o=e[n].x,l=e[n].y,u=s>t.y!=l>t.y&&t.x<(o-a)*(t.y-s)/(l-s)+a;u&&(r=!r)}return r}function ti(t){for(var e=0,r=0;r<t.length;r++){let i=(r+1)%t.length;e+=t[r].x*t[i].y,e-=t[i].x*t[r].y}return e<0}function ri(t,e){var r=!1;for(let i of e)if(ti(i))Pt(t,i)&&(r=!1);else{if(r)return!0;Pt(t,i)&&(r=!0)}return r}function ii(t,e){let r=1/0;for(let i of e){let n=Math.sqrt(st(t,i[0]));n<r&&(r=n)}return r}function ni(t,e){let r=1/0;for(let n of e)for(var i=0;i<n.length-1;i++){let a=Math.sqrt(ha(t,n[i],n[i+1]));a<r&&(r=a)}return r}var ot=class{constructor(e,r){this.source=e,this.cache=new Map,this.inflight=new Map,this.tileSize=r}queryFeatures(e,r,i,n){let a=ua([r,e]);var s=new Se.default((a.x+at)/(at*2),1-(a.y+at)/(at*2));s.x>1&&(s.x=s.x-Math.floor(s.x));let o=s.mult(1<<i),l=Math.floor(o.x),u=Math.floor(o.y),h=se({z:i,x:l,y:u}),f=[],c=this.cache.get(h);if(c){let g=new Se.default((o.x-l)*this.tileSize,(o.y-u)*this.tileSize);for(let[w,v]of c.data.entries())for(let d of v)d.geomType==1?ii(g,d.geom)<n&&f.push({feature:d,layerName:w}):d.geomType==2?ni(g,d.geom)<n&&f.push({feature:d,layerName:w}):ri(g,d.geom)&&f.push({feature:d,layerName:w})}return f}get(e){return E(this,null,function*(){let r=se(e);return new Promise((i,n)=>{let a=this.cache.get(r);if(a)a.used=performance.now(),i(a.data);else{let s=this.inflight.get(r);s?s.push([i,n]):(this.inflight.set(r,[]),this.source.get(e,this.tileSize).then(o=>{this.cache.set(r,{used:performance.now(),data:o});let l=this.inflight.get(r);if(l&&l.forEach(u=>u[0](o)),this.inflight.delete(r),i(o),this.cache.size>=64){let u=1/0,h;this.cache.forEach((f,c)=>{f.used<u&&(u=f.used,h=c)}),h&&this.cache.delete(h)}}).catch(o=>{let l=this.inflight.get(r);l&&l.forEach(u=>u[1](o)),this.inflight.delete(r),n(o)}))}})})}};var Xe=(t,e,r)=>{let i=[];for(let n of t){let a=[];for(let s of n)a.push(s.clone().mult(e).add(r));i.push(a)}return i},Ve=(t,e)=>{let r=1<<e;return t<0&&(t=r+t),t>=r&&(t=t%r),t},Dt=class{constructor(e,r,i){this.tileCache=e,this.maxDataLevel=r,this.levelDiff=i}dataTilesForBounds(e,r){let i=Math.pow(2,e)/Math.pow(2,Math.ceil(e)),n=[];var a=1,s=this.tileCache.tileSize;if(e<this.levelDiff)a=1/(1<<this.levelDiff-e)*i,n.push({data_tile:{z:0,x:0,y:0},origin:new ye.default(0,0),scale:a,dim:s*a});else if(e<=this.levelDiff+this.maxDataLevel){let u=1<<this.levelDiff,h=256*i,f=Math.ceil(e)-this.levelDiff,c=Math.floor(r.minX/u/h),g=Math.floor(r.minY/u/h),w=Math.floor(r.maxX/u/h),v=Math.floor(r.maxY/u/h);for(var o=c;o<=w;o++)for(var l=g;l<=v;l++){let d=new ye.default(o*u*h,l*u*h);n.push({data_tile:{z:f,x:Ve(o,f),y:Ve(l,f)},origin:d,scale:i,dim:s*i})}}else{let u=1<<this.levelDiff;a=(1<<Math.ceil(e)-this.maxDataLevel-this.levelDiff)*i;let h=Math.floor(r.minX/u/256/a),f=Math.floor(r.minY/u/256/a),c=Math.floor(r.maxX/u/256/a),g=Math.floor(r.maxY/u/256/a);for(var o=h;o<=c;o++)for(var l=f;l<=g;l++){let d=new ye.default(o*u*256*a,l*u*256*a);n.push({data_tile:{z:this.maxDataLevel,x:Ve(o,this.maxDataLevel),y:Ve(l,this.maxDataLevel)},origin:d,scale:a,dim:s*a})}}return n}dataTileForDisplayTile(e){var r,i=1,n=this.tileCache.tileSize,a;if(e.z<this.levelDiff)r={z:0,x:0,y:0},i=1/(1<<this.levelDiff-e.z),a=new ye.default(0,0),n=n*i;else if(e.z<=this.levelDiff+this.maxDataLevel){let s=1<<this.levelDiff;r={z:e.z-this.levelDiff,x:Math.floor(e.x/s),y:Math.floor(e.y/s)},a=new ye.default(r.x*s*256,r.y*s*256)}else{i=1<<e.z-this.maxDataLevel-this.levelDiff;let s=1<<this.levelDiff;r={z:this.maxDataLevel,x:Math.floor(e.x/s/i),y:Math.floor(e.y/s/i)},a=new ye.default(r.x*s*i*256,r.y*s*i*256),n=n*i}return{data_tile:r,scale:i,origin:a,dim:n}}getBbox(e,r){return E(this,null,function*(){let i=this.dataTilesForBounds(e,r);return(yield Promise.all(i.map(a=>this.tileCache.get(a.data_tile)))).map((a,s)=>{let o=i[s];return{data:a,z:e,data_tile:o.data_tile,scale:o.scale,dim:o.dim,origin:o.origin}})})}getDisplayTile(e){return E(this,null,function*(){let r=this.dataTileForDisplayTile(e);return{data:yield this.tileCache.get(r.data_tile),z:e.z,data_tile:r.data_tile,scale:r.scale,origin:r.origin,dim:r.dim}})}queryFeatures(e,r,i){let n=Math.round(i),a=Math.min(n-this.levelDiff,this.maxDataLevel),s=16/(1<<n-a);return this.tileCache.queryFeatures(e,r,a,s)}},Ye=t=>{let e=i=>{let n=i.levelDiff===void 0?2:i.levelDiff,a=i.maxDataZoom||14,s;typeof i.url=="string"?i.url.endsWith(".pmtiles")?s=new Ie(i.url,!0,i.headers):s=new nt(i.url,!0,i.headers):s=new Ie(i.url,!0,i.headers);let o=new ot(s,256*1<<n);return new Dt(o,a,n)},r=new Map;if(t.sources)for(let i in t.sources)r.set(i,e(t.sources[i]));else r.set("",e(t));return r};var ai=Y(ie());function Ue(t,e,r,i,n,a,s,o,l){let u=performance.now();t.save(),t.miterLimit=2;for(var h of n){if(h.minzoom&&e<h.minzoom||h.maxzoom&&e>h.maxzoom)continue;let w=r.get(h.dataSource||"");if(!!w)for(let v of w){var f=v.data.get(h.dataLayer);if(f===void 0)continue;h.symbolizer.before&&h.symbolizer.before(t,v.z);let d=v.origin,m=v.dim,p=v.scale;if(t.save(),o){t.beginPath();let b=Math.max(d.x-s.x,a.minX-s.x),y=Math.max(d.y-s.y,a.minY-s.y),x=Math.min(d.x-s.x+m,a.maxX-s.x),z=Math.min(d.y-s.y+m,a.maxY-s.y);t.rect(b,y,x-b,z-y),t.clip()}t.translate(d.x-s.x,d.y-s.y);for(var c of f){let b=c.geom,y=c.bbox;y.maxX*p+d.x<a.minX||y.minX*p+d.x>a.maxX||y.minY*p+d.y>a.maxY||y.maxY*p+d.y<a.minY||h.filter&&!h.filter(v.z,c)||(p!=1&&(b=Xe(b,p,new ai.default(0,0))),h.symbolizer.draw(t,b,v.z,c))}t.restore()}}if(o&&(t.beginPath(),t.rect(a.minX-s.x,a.minY-s.y,a.maxX-a.minX,a.maxY-a.minY),t.clip()),i){let w=i.searchBbox(a,1/0);for(var g of w)if(t.save(),t.translate(g.anchor.x-s.x,g.anchor.y-s.y),g.draw(t),t.restore(),l){t.lineWidth=.5,t.strokeStyle=l,t.fillStyle=l,t.globalAlpha=1,t.fillRect(g.anchor.x-s.x-2,g.anchor.y-s.y-2,4,4);for(let v of g.bboxes)t.strokeRect(v.minX-s.x,v.minY-s.y,v.maxX-v.minX,v.maxY-v.minY)}}return t.restore(),performance.now()-u}var oi=Y(ie()),li=Y(si());var ui=(t,e,r)=>{let i=256,n=e/i,a=Math.floor(r.minX/i),s=Math.floor(r.minY/i),o=Math.floor(r.maxX/i),l=Math.floor(r.maxY/i),u=Math.log2(n),h=[];for(let f=a;f<=o;f++){let c=f%(1<<t);for(let g=s;g<=l;g++)h.push({display:se({z:t,x:c,y:g}),key:se({z:t-u,x:Math.floor(c/n),y:Math.floor(g/n)})})}return h},Ot=class{constructor(e,r){this.tree=new li.default,this.current=new Map,this.dim=e,this.maxLabeledTiles=r}hasPrefix(e){for(let r of this.current.keys())if(r.startsWith(e))return!0;return!1}has(e){return this.current.has(e)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(e,r){let i=new Set;for(let n of this.tree.search(e))n.indexed_label.order<=r&&i.add(n.indexed_label);return i}searchLabel(e,r){let i=new Set;for(let n of e.bboxes)for(let a of this.tree.search(n))a.indexed_label.order<=r&&i.add(a.indexed_label);return i}bboxCollides(e,r){for(let i of this.tree.search(e))if(i.indexed_label.order<=r)return!0;return!1}labelCollides(e,r){for(let i of e.bboxes)for(let n of this.tree.search(i))if(n.indexed_label.order<=r)return!0;return!1}deduplicationCollides(e){if(!e.deduplicationKey||!e.deduplicationDistance)return!1;let r=e.deduplicationDistance,i={minX:e.anchor.x-r,minY:e.anchor.y-r,maxX:e.anchor.x+r,maxY:e.anchor.y+r};for(let n of this.tree.search(i))if(n.indexed_label.deduplicationKey===e.deduplicationKey&&n.indexed_label.anchor.dist(e.anchor)<r)return!0;return!1}makeEntry(e){this.current.get(e)&&console.log("consistency error 1");let r=new Set;this.current.set(e,r)}insert(e,r,i){let n={anchor:e.anchor,bboxes:e.bboxes,draw:e.draw,order:r,tileKey:i,deduplicationKey:e.deduplicationKey,deduplicationDistance:e.deduplicationDistance},a=this.current.get(i);if(!a){let f=new Set;this.current.set(i,f),a=f}a.add(n);var s=!1,o=!1;for(let f of e.bboxes){var l=f;l.indexed_label=n,this.tree.insert(l),f.minX<0&&(s=!0),f.maxX>this.dim&&(o=!0)}if(s||o){var u=s?this.dim:-this.dim,h=[];for(let g of e.bboxes)h.push({minX:g.minX+u,minY:g.minY,maxX:g.maxX+u,maxY:g.maxY});let f={anchor:new oi.default(e.anchor.x+u,e.anchor.y),bboxes:h,draw:e.draw,order:r,tileKey:i},c=this.current.get(i);c&&c.add(f);for(let g of h){var l=g;l.indexed_label=f,this.tree.insert(l)}}}pruneOrNoop(e){let r=e.split(":"),i,n=0,a=0;for(var s of this.current.keys()){let o=s.split(":");if(o[3]===r[3]){a++;let l=Math.sqrt(Math.pow(+o[0]-+r[0],2)+Math.pow(+o[1]-+r[1],2));l>n&&(n=l,i=s)}i&&a>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(e){let r=this.current.get(e);if(!r)return;let i=[];for(let n of this.tree.all())r.has(n.indexed_label)&&i.push(n);i.forEach(n=>{this.tree.remove(n)}),this.current.delete(e)}removeLabel(e){let r=[];for(let n of this.tree.all())e==n.indexed_label&&r.push(n);r.forEach(n=>{this.tree.remove(n)});let i=this.current.get(e.tileKey);i&&i.delete(e)}},je=class{constructor(e,r,i,n,a){this.index=new Ot(256*1<<e,n),this.z=e,this.scratch=r,this.labelRules=i,this.callback=a}layout(e){let r=performance.now(),i=new Set;for(let[o,l]of e)for(let u of l){let h=se(u.data_tile)+":"+o;this.index.has(h)||(this.index.makeEntry(h),i.add(h))}let n=new Set;for(let[o,l]of this.labelRules.entries()){if(l.visible==!1||l.minzoom&&this.z<l.minzoom||l.maxzoom&&this.z>l.maxzoom)continue;let u=l.dataSource||"",h=e.get(u);if(!!h)for(let f of h){let c=se(f.data_tile)+":"+u;if(!i.has(c))continue;let g=f.data.get(l.dataLayer);if(g===void 0)continue;let w=g;l.sort&&w.sort((d,m)=>l.sort?l.sort(d.props,m.props):0);let v={index:this.index,zoom:this.z,scratch:this.scratch,order:o,overzoom:this.z-f.data_tile.z};for(let d of w){if(l.filter&&!l.filter(this.z,d))continue;let m=Xe(d.geom,f.scale,f.origin),p=l.symbolizer.place(v,m,d);if(!!p)for(let b of p){var a=!1;if(!(b.deduplicationKey&&this.index.deduplicationCollides(b))){if(this.index.labelCollides(b,1/0)){if(!this.index.labelCollides(b,o)){let y=this.index.searchLabel(b,1/0);for(let x of y){this.index.removeLabel(x);for(let z of x.bboxes)this.findInvalidatedTiles(n,f.dim,z,c)}this.index.insert(b,o,c),a=!0}}else this.index.insert(b,o,c),a=!0;if(a)for(let y of b.bboxes)(y.maxX>f.origin.x+f.dim||y.minX<f.origin.x||y.minY<f.origin.y||y.maxY>f.origin.y+f.dim)&&this.findInvalidatedTiles(n,f.dim,y,c)}}}}}for(var s of i)this.index.pruneOrNoop(s);return n.size>0&&this.callback&&this.callback(n),performance.now()-r}findInvalidatedTiles(e,r,i,n){let a=ui(this.z,r,i);for(let s of a)s.key!=n&&this.index.hasPrefix(s.key)&&e.add(s.display)}add(e){var r=!0;for(let[i,n]of e)for(let a of n)this.index.has(se(a.data_tile)+":"+i)||(r=!1);return r?0:this.layout(e)}},Ne=class{constructor(e,r,i,n){this.labelers=new Map,this.scratch=e,this.labelRules=r,this.maxLabeledTiles=i,this.callback=n}add(e,r){var i=this.labelers.get(e);return i||(i=new je(e,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(e,i)),i.add(r)}getIndex(e){let r=this.labelers.get(e);if(r)return r.index}};var Fe={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"};var Me={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function $e(t,e,r){return Math.min(Math.max(t,r),e)}var Ce=class extends Error{constructor(e){super(`Failed to parse color: "${e}"`)}};function fa(t){if(typeof t!="string")throw new Ce(t);if(t.trim().toLowerCase()==="transparent")return[0,0,0,0];let e=t.trim();e=ga.test(t)?function(s){let o=s.toLowerCase().trim(),l=da[function(u){let h=5381,f=u.length;for(;f;)h=33*h^u.charCodeAt(--f);return(h>>>0)%2341}(o)];if(!l)throw new Ce(s);return`#${l}`}(t):t;let r=ca.exec(e);if(r){let s=Array.from(r).slice(1);return[...s.slice(0,3).map(o=>parseInt(qe(o,2),16)),parseInt(qe(s[3]||"f",2),16)/255]}let i=ma.exec(e);if(i){let s=Array.from(i).slice(1);return[...s.slice(0,3).map(o=>parseInt(o,16)),parseInt(s[3]||"ff",16)/255]}let n=pa.exec(e);if(n){let s=Array.from(n).slice(1);return[...s.slice(0,3).map(o=>parseInt(o,10)),parseFloat(s[3]||"1")]}let a=ya.exec(e);if(a){let[s,o,l,u]=Array.from(a).slice(1).map(parseFloat);if($e(0,100,o)!==o)throw new Ce(t);if($e(0,100,l)!==l)throw new Ce(t);return[...xa(s,o,l),u||1]}throw new Ce(t)}var hi=t=>parseInt(t.replace(/_/g,""),36),da="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((t,e)=>{let r=hi(e.substring(0,3)),i=hi(e.substring(3)).toString(16),n="";for(let a=0;a<6-i.length;a++)n+="0";return t[r]=`${n}${i}`,t},{}),qe=(t,e)=>Array.from(Array(e)).map(()=>t).join(""),ca=new RegExp(`^#${qe("([a-f0-9])",3)}([a-f0-9])?$`,"i"),ma=new RegExp(`^#${qe("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),pa=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${qe(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),ya=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ga=/^[a-z]+$/i,fi=t=>Math.round(255*t),xa=(t,e,r)=>{let i=r/100;if(e===0)return[i,i,i].map(fi);let n=(t%360+360)%360/60,a=(1-Math.abs(2*i-1))*(e/100),s=a*(1-Math.abs(n%2-1)),o=0,l=0,u=0;n>=0&&n<1?(o=a,l=s):n>=1&&n<2?(o=s,l=a):n>=2&&n<3?(l=a,u=s):n>=3&&n<4?(l=s,u=a):n>=4&&n<5?(o=s,u=a):n>=5&&n<6&&(o=a,u=s);let h=i-a/2;return[o+h,l+h,u+h].map(fi)};function Rt(t){let[e,r,i,n]=fa(t).map((u,h)=>h===3?u:u/255),a=Math.max(e,r,i),s=Math.min(e,r,i),o=(a+s)/2;if(a===s)return[0,0,o,n];let l=a-s;return[60*(e===a?(r-i)/l+(r<i?6:0):r===a?(i-e)/l+2:(e-r)/l+4),o>.5?l/(2-a-s):l/(a+s),o,n]}function di(t,e,r,i){return`hsla(${(t%360).toFixed()}, ${$e(0,100,100*e).toFixed()}%, ${$e(0,100,100*r).toFixed()}%, ${parseFloat($e(0,1,i).toFixed(3))})`}var Z=Y(ie()),bi=Y(ci()),wi=Y(yi());var X=class{constructor(e,r){this.str=e!=null?e:r,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(e,r){return typeof this.str=="function"?this.str(e,r):this.str}},B=class{constructor(e,r=1){this.value=e!=null?e:r,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(e,r){return typeof this.value=="function"?this.value(e,r):this.value}},He=class{constructor(e){var r;this.label_props=(r=e==null?void 0:e.label_props)!=null?r:["name"],this.textTransform=e==null?void 0:e.textTransform}get(e,r){let i,n;typeof this.label_props=="function"?n=this.label_props(e,r):n=this.label_props;for(let s of n)if(r.props.hasOwnProperty(s)&&typeof r.props[s]=="string"){i=r.props[s];break}let a;return typeof this.textTransform=="function"?a=this.textTransform(e,r):a=this.textTransform,i&&a==="uppercase"?i=i.toUpperCase():i&&a==="lowercase"?i=i.toLowerCase():i&&a==="capitalize"&&(i=i.toLowerCase().split(" ").map(l=>l[0].toUpperCase()+l.slice(1)).join(" ")),i}},Ze=class{constructor(e){var r,i;(e==null?void 0:e.font)?this.font=e.font:(this.family=(r=e==null?void 0:e.fontFamily)!=null?r:"sans-serif",this.size=(i=e==null?void 0:e.fontSize)!=null?i:12,this.weight=e==null?void 0:e.fontWeight,this.style=e==null?void 0:e.fontStyle)}get(e,r){if(this.font)return typeof this.font=="function"?this.font(e,r):this.font;var i="";this.style&&(typeof this.style=="function"?i=this.style(e,r)+" ":i=this.style+" ");var n="";this.weight&&(typeof this.weight=="function"?n=this.weight(e,r)+" ":n=this.weight+" ");var a;typeof this.size=="function"?a=this.size(e,r):a=this.size;var s;return typeof this.family=="function"?s=this.family(e,r):s=this.family,`${i}${n}${a}px ${s}`}},Vt=class{constructor(e,r=[]){this.value=e!=null?e:r,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(e,r){return typeof this.value=="function"?this.value(e,r):this.value}};var Yt=Y(ie()),za=(t,e,r)=>{var i=[],n,a,s,o=0,l=0,u=0,h=0,f=0,c=0,g=0,w=0,v=0,d=0,m=0,p=0;if(t.length<2)return[];if(t.length===2)return u=Math.sqrt(Math.pow(t[1].x-t[0].x,2)+Math.pow(t[1].y-t[0].y,2)),[{length:u,beginIndex:0,beginDistance:0,endIndex:2,endDistance:u}];for(h=Math.sqrt(Math.pow(t[1].x-t[0].x,2)+Math.pow(t[1].y-t[0].y,2)),o=1,l=t.length-1;o<l;o++)n=t[o-1],a=t[o],s=t[o+1],c=a.x-n.x,g=a.y-n.y,w=s.x-a.x,v=s.y-a.y,f=Math.sqrt(w*w+v*v),u+=h,d=Math.acos((c*w+g*v)/(h*f)),(d>e||u-p>r)&&(i.push({length:u-p,beginDistance:p,beginIndex:m,endIndex:o+1,endDistance:u}),m=o,p=u),h=f;return o-m>0&&i.push({length:u-p+f,beginIndex:m,beginDistance:p,endIndex:o+1,endDistance:u+f}),i};function gi(t,e,r,i){let n,a,s=0,o=[];var l=-1/0;for(let h of t){let f=za(h,Math.PI/45,e);for(let c of f)if(c.length>=e+i){let g=new Yt.default(h[c.beginIndex].x,h[c.beginIndex].y),w=h[c.endIndex-1],v=new Yt.default((w.x-g.x)/c.length,(w.y-g.y)/c.length);for(var u=i;u<c.length-e;u+=r)o.push({start:g.add(v.mult(u)),end:g.add(v.mult(u+e))})}}return o}function xi(t,e,r,i){let n=e.x-t.x,a=e.y-t.y,s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=[];for(var l=0;l<r+i;l+=2*i){let u=l*1/s;o.push({x:t.x+u*n,y:t.y+u*a})}return o}function Ut(t,e){if(t.length<=e)return[t];let r=e-1,i=t.lastIndexOf(" ",r),n=t.indexOf(" ",r);if(i==-1&&n==-1)return[t];let a,s;return n==-1||i>=0&&r-i<n-r?(a=t.substring(0,i),s=t.substring(i+1,t.length)):(a=t.substring(0,n),s=t.substring(n+1,t.length)),[a,...Ut(s,e)]}var La="\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DB5\u4E00-\u9FEA\uF900-\uFA6D\uFA70-\uFAD9\u2000",ys=new RegExp("^["+La+"]+$");var vi=5400,V;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(V||(V={}));var D;(function(l){l[l.N=1]="N",l[l.NE=2]="NE",l[l.E=3]="E",l[l.SE=4]="SE",l[l.S=5]="S",l[l.SW=6]="SW",l[l.W=7]="W",l[l.NW=8]="NW"})(D||(D={}));var jt=(t,e,r)=>{let i=document.createElement("canvas"),n=i.getContext("2d");return i.width=t,i.height=e,n!==null&&r(i,n),i},A=class{constructor(e){var r;this.pattern=e.pattern,this.fill=new X(e.fill,"black"),this.opacity=new B(e.opacity,1),this.stroke=new X(e.stroke,"black"),this.width=new B(e.width,0),this.per_feature=(r=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||e.per_feature)!=null?r:!1,this.do_stroke=!1}before(e,r){if(!this.per_feature){e.globalAlpha=this.opacity.get(r),e.fillStyle=this.fill.get(r),e.strokeStyle=this.stroke.get(r);let i=this.width.get(r);i>0&&(this.do_stroke=!0),e.lineWidth=i}if(this.pattern){let i=e.createPattern(this.pattern,"repeat");i&&(e.fillStyle=i)}}draw(e,r,i,n){var a=!1;if(this.per_feature){e.globalAlpha=this.opacity.get(i,n),e.fillStyle=this.fill.get(i,n);var s=this.width.get(i,n);s&&(a=!0,e.strokeStyle=this.stroke.get(i,n),e.lineWidth=s)}let o=()=>{e.fill(),(a||this.do_stroke)&&e.stroke()};var l=0;e.beginPath();for(var u of r){l+u.length>vi&&(o(),l=0,e.beginPath());for(var h=0;h<u.length;h++){let f=u[h];h==0?e.moveTo(f.x,f.y):e.lineTo(f.x,f.y)}l+=u.length}l>0&&o()}};function de(t,e){return r=>{let i=r-t;return i>=0&&i<e.length?e[i]:0}}function _i(t,e){let r=0;for(;e[r+1][0]<t;)r++;return r}function zi(t,e,r){return t*(r-e)+e}function Li(t,e,r,i){let n=i[e+1][0]-i[e][0],a=t-i[e][0];return n===0?0:r===1?a/n:(Math.pow(r,a)-1)/(Math.pow(r,n)-1)}function j(t,e){return r=>{if(e.length<1)return 0;if(r<=e[0][0])return e[0][1];if(r>=e[e.length-1][0])return e[e.length-1][1];let i=_i(r,e),n=Li(r,i,t,e);return zi(n,e[i][1],e[i+1][1])}}function ka(t,e){return r=>{if(e.length<1)return 0;let i=t;for(let n=0;n<e.length;n++)r>=e[n][0]&&(i=e[n][1]);return i}}function Sa(t){return j(1,t)}function Fa(t,e,r,i,n){return a=>{if(n.length<1)return 0;let s=new bi.default(t,e,r,i),o=_i(a,n),l=s.solve(Li(a,o,1,n));return zi(l,n[o][1],n[o+1][1])}}var P=class{constructor(e){var r;this.color=new X(e.color,"black"),this.width=new B(e.width),this.opacity=new B(e.opacity),this.dash=e.dash?new Vt(e.dash):null,this.dashColor=new X(e.dashColor,"black"),this.dashWidth=new B(e.dashWidth,1),this.lineCap=new X(e.lineCap,"butt"),this.lineJoin=new X(e.lineJoin,"miter"),this.skip=!1,this.per_feature=!!(((r=this.dash)==null?void 0:r.per_feature)||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||e.per_feature)}before(e,r){this.per_feature||(e.strokeStyle=this.color.get(r),e.lineWidth=this.width.get(r),e.globalAlpha=this.opacity.get(r),e.lineCap=this.lineCap.get(r),e.lineJoin=this.lineJoin.get(r))}draw(e,r,i,n){if(this.skip)return;let a=()=>{this.per_feature&&(e.globalAlpha=this.opacity.get(i,n),e.lineCap=this.lineCap.get(i,n),e.lineJoin=this.lineJoin.get(i,n)),this.dash?(e.save(),this.per_feature?(e.lineWidth=this.dashWidth.get(i,n),e.strokeStyle=this.dashColor.get(i,n),e.setLineDash(this.dash.get(i,n))):e.setLineDash(this.dash.get(i)),e.stroke(),e.restore()):(e.save(),this.per_feature&&(e.lineWidth=this.width.get(i,n),e.strokeStyle=this.color.get(i,n)),e.stroke(),e.restore())};var s=0;e.beginPath();for(var o of r){s+o.length>vi&&(a(),s=0,e.beginPath());for(var l=0;l<o.length;l++){let u=o[l];l==0?e.moveTo(u.x,u.y):e.lineTo(u.x,u.y)}s+=o.length}s>0&&a()}},ki=class{constructor(e){this.name=e.name,this.sheet=e.sheet,this.dpr=window.devicePixelRatio}place(e,r,i){let n=r[0],a=new Z.default(r[0][0].x,r[0][0].y),s=this.sheet.get(this.name),o=s.w/this.dpr,l=s.h/this.dpr,u={minX:a.x-o/2,minY:a.y-l/2,maxX:a.x+o/2,maxY:a.y+l/2};return[{anchor:a,bboxes:[u],draw:f=>{f.globalAlpha=1,f.drawImage(this.sheet.canvas,s.x,s.y,s.w,s.h,-s.w/2/this.dpr,-s.h/2/this.dpr,s.w/2,s.h/2)}}]}},te=class{constructor(e){this.radius=new B(e.radius,3),this.fill=new X(e.fill,"black"),this.stroke=new X(e.stroke,"white"),this.width=new B(e.width,0),this.opacity=new B(e.opacity)}draw(e,r,i,n){e.globalAlpha=this.opacity.get(i,n);let a=this.radius.get(i,n),s=this.width.get(i,n);s>0&&(e.strokeStyle=this.stroke.get(i,n),e.lineWidth=s,e.beginPath(),e.arc(r[0][0].x,r[0][0].y,a+s/2,0,2*Math.PI),e.stroke()),e.fillStyle=this.fill.get(i,n),e.beginPath(),e.arc(r[0][0].x,r[0][0].y,a,0,2*Math.PI),e.fill()}place(e,r,i){let n=r[0],a=new Z.default(r[0][0].x,r[0][0].y),s=this.radius.get(e.zoom,i),o={minX:a.x-s,minY:a.y-s,maxX:a.x+s,maxY:a.y+s};return[{anchor:a,bboxes:[o],draw:u=>{this.draw(u,[[new Z.default(0,0)]],e.zoom,i)}}]}},ut=class{constructor(e){this.font=new Ze(e),this.text=new He(e),this.fill=new X(e.fill,"black"),this.background=new X(e.background,"white"),this.padding=new B(e.padding,0)}place(e,r,i){let n=this.text.get(e.zoom,i);if(!n)return;let a=this.font.get(e.zoom,i);e.scratch.font=a;let s=e.scratch.measureText(n),o=s.width,l=s.actualBoundingBoxAscent,u=s.actualBoundingBoxDescent,h=r[0],f=new Z.default(r[0][0].x,r[0][0].y),c=this.padding.get(e.zoom,i),g={minX:f.x-o/2-c,minY:f.y-l-c,maxX:f.x+o/2+c,maxY:f.y+u+c};return[{anchor:f,bboxes:[g],draw:v=>{v.globalAlpha=1,v.fillStyle=this.background.get(e.zoom,i),v.fillRect(-o/2-c,-l-c,o+2*c,l+u+2*c),v.fillStyle=this.fill.get(e.zoom,i),v.font=a,v.fillText(n,-o/2,0)}}]}},We=class{constructor(e){this.list=e}place(e,r,i){var n=this.list[0].place(e,r,i);if(!n)return;var a=n[0];let s=a.anchor,o=a.bboxes[0],l=o.maxY-o.minY,u=[{draw:a.draw,translate:{x:0,y:0}}],h=[[new Z.default(r[0][0].x,r[0][0].y+l)]];for(let c=1;c<this.list.length;c++)n=this.list[c].place(e,h,i),n&&(a=n[0],o=Si(o,a.bboxes[0]),u.push({draw:a.draw,translate:{x:0,y:l}}));return[{anchor:s,bboxes:[o],draw:c=>{for(let g of u)c.save(),c.translate(g.translate.x,g.translate.y),g.draw(c),c.restore()}}]}},Si=(t,e)=>({minX:Math.min(t.minX,e.minX),minY:Math.min(t.minY,e.minY),maxX:Math.max(t.maxX,e.maxX),maxY:Math.max(t.maxY,e.maxY)}),ge=class{constructor(e){this.list=e}place(e,r,i){let n=this.list[0];if(!n)return;var a=n.place(e,r,i);if(!a)return;var s=a[0];let o=s.anchor,l=s.bboxes[0],u=[s.draw];for(let f=1;f<this.list.length;f++){if(a=this.list[f].place(e,r,i),!a)return;s=a[0],l=Si(l,s.bboxes[0]),u.push(s.draw)}return[{anchor:o,bboxes:[l],draw:f=>{u.forEach(c=>c(f))}}]}},Nt=class{constructor(e){this.symbolizer=e}place(e,r,i){let n=r[0][0],a=this.symbolizer.place(e,[[new Z.default(0,0)]],i);if(!a||a.length==0)return;let s=a[0],o=s.bboxes[0],l=o.maxX-o.minX,u=o.maxY-o.minY,h={minX:n.x-l/2,maxX:n.x+l/2,minY:n.y-u/2,maxY:n.y+u/2};return[{anchor:n,bboxes:[h],draw:c=>{c.translate(-l/2,u/2-o.maxY),s.draw(c,{justify:2})}}]}},Fi=class{constructor(e,r){this.padding=new B(e,0),this.symbolizer=r}place(e,r,i){let n=this.symbolizer.place(e,r,i);if(!n||n.length==0)return;let a=this.padding.get(e.zoom,i);for(var s of n)for(var o of s.bboxes)o.minX-=a,o.minY-=a,o.maxX+=a,o.maxY+=a;return n}},Ke=class{constructor(e){this.font=new Ze(e),this.text=new He(e),this.fill=new X(e.fill,"black"),this.stroke=new X(e.stroke,"black"),this.width=new B(e.width,0),this.lineHeight=new B(e.lineHeight,1),this.letterSpacing=new B(e.letterSpacing,0),this.maxLineCodeUnits=new B(e.maxLineChars,15),this.justify=e.justify}place(e,r,i){let n=this.text.get(e.zoom,i);if(!n)return;let a=this.font.get(e.zoom,i);e.scratch.font=a;let s=this.letterSpacing.get(e.zoom,i),o=Ut(n,this.maxLineCodeUnits.get(e.zoom,i));var l="",u=0;for(let p of o)p.length>u&&(u=p.length,l=p);let h=e.scratch.measureText(l),f=h.width+s*(u-1),c=h.actualBoundingBoxAscent,g=h.actualBoundingBoxDescent,w=(c+g)*this.lineHeight.get(e.zoom,i),v=new Z.default(r[0][0].x,r[0][0].y),d={minX:v.x,minY:v.y-c,maxX:v.x+f,maxY:v.y+g+(o.length-1)*w};return[{anchor:v,bboxes:[d],draw:(p,b)=>{p.globalAlpha=1,p.font=a,p.fillStyle=this.fill.get(e.zoom,i);let y=this.width.get(e.zoom,i);var x=0;for(let S of o){var z=0;if(this.justify==2||b&&b.justify==2?z=(f-p.measureText(S).width)/2:(this.justify==3||b&&b.justify==3)&&(z=f-p.measureText(S).width),y)if(p.lineWidth=y*2,p.strokeStyle=this.stroke.get(e.zoom,i),s>0){var _=z;for(var k of S)p.strokeText(k,_,x),_+=p.measureText(k).width+s}else p.strokeText(S,z,x);if(s>0){var _=z;for(var k of S)p.fillText(k,_,x),_+=p.measureText(k).width+s}else p.fillText(S,z,x);x+=w}}}]}},U=class{constructor(e){this.centered=new Nt(new Ke(e))}place(e,r,i){return this.centered.place(e,r,i)}},$t=class{constructor(e,r){var i,n,a;this.symbolizer=e,this.offsetX=new B(r.offsetX,0),this.offsetY=new B(r.offsetY,0),this.justify=(i=r.justify)!=null?i:void 0,this.placements=(n=r.placements)!=null?n:[2,6,8,4,1,3,5,7],this.ddValues=(a=r.ddValues)!=null?a:()=>({})}place(e,r,i){if(i.geomType!==ee.Point)return;let n=r[0][0],a=this.symbolizer.place(e,[[new Z.default(0,0)]],i);if(!a||a.length==0)return;let s=a[0],o=s.bboxes[0],l=this.offsetX,u=this.offsetY,h=this.justify,f=this.placements,{offsetX:c,offsetY:g,justify:w,placements:v}=this.ddValues(e.zoom,i)||{};c&&(l=new B(c,0)),g&&(u=new B(g,0)),w&&(h=w),v&&(f=v);let d=l.get(e.zoom,i),m=u.get(e.zoom,i),p=(_,k)=>({minX:_.x+k.x+o.minX,minY:_.y+k.y+o.minY,maxX:_.x+k.x+o.maxX,maxY:_.y+k.y+o.maxY});var b=new Z.default(d,m),y;let x=_=>{_.translate(b.x,b.y),s.draw(_,{justify:y})},z=(_,k)=>{let S=p(_,k);if(!e.index.bboxCollides(S,e.order))return[{anchor:n,bboxes:[S],draw:x}]};for(let _ of f){let k=this.computeXAxisOffset(d,o,_),S=this.computeYAxisOffset(m,o,_);return y=this.computeJustify(h,_),b=new Z.default(k,S),z(n,b)}}computeXAxisOffset(e,r,i){let n=r.maxX,a=n/2;return[1,5].includes(i)?e-a:[8,7,6].includes(i)?e-n:e}computeYAxisOffset(e,r,i){let n=Math.abs(r.minY),a=r.maxY,s=(r.minY+r.maxY)/2;return[3,7].includes(i)?e-s:[8,2,1].includes(i)?e-a:[6,4,5].includes(i)?e+n:e}computeJustify(e,r){return e||([1,5].includes(r)?2:[2,3,4].includes(r)?1:3)}},oe=class{constructor(e){this.symbolizer=new $t(new Ke(e),e)}place(e,r,i){return this.symbolizer.place(e,r,i)}},Te;(function(i){i[i.Above=1]="Above",i[i.Center=2]="Center",i[i.Below=3]="Below"})(Te||(Te={}));var ce=class{constructor(e){var r;this.font=new Ze(e),this.text=new He(e),this.fill=new X(e.fill,"black"),this.stroke=new X(e.stroke,"black"),this.width=new B(e.width,0),this.offset=new B(e.offset,0),this.position=(r=e.position)!=null?r:1,this.maxLabelCodeUnits=new B(e.maxLabelChars,40),this.repeatDistance=new B(e.repeatDistance,250)}place(e,r,i){let n=this.text.get(e.zoom,i);if(!n||n.length>this.maxLabelCodeUnits.get(e.zoom,i))return;let a=20,s=i.bbox;if(s.maxY-s.minY<a&&s.maxX-s.minX<a)return;let o=this.font.get(e.zoom,i);e.scratch.font=o;let l=e.scratch.measureText(n),u=l.width,h=l.actualBoundingBoxAscent+l.actualBoundingBoxDescent;var f=this.repeatDistance.get(e.zoom,i);e.overzoom>4&&(f*=1<<e.overzoom-4);let c=h*2,g=gi(r,u,f,c);if(g.length==0)return;let w=[];for(let v of g){let d=v.end.x-v.start.x,m=v.end.y-v.start.y,b=xi(v.start,v.end,u,c/2).map(x=>({minX:x.x-c/2,minY:x.y-c/2,maxX:x.x+c/2,maxY:x.y+c/2})),y=x=>{x.globalAlpha=1,x.rotate(Math.atan2(m,d)),d<0&&(x.scale(-1,-1),x.translate(-u,0));let z=0;this.position===3?z+=h:this.position===2&&(z+=h/2),x.translate(0,z-this.offset.get(e.zoom,i)),x.font=o;let _=this.width.get(e.zoom,i);_&&(x.lineWidth=_,x.strokeStyle=this.stroke.get(e.zoom,i),x.strokeText(n,0,0)),x.fillStyle=this.fill.get(e.zoom,i),x.fillText(n,0,0)};w.push({anchor:v.start,bboxes:b,draw:y,deduplicationKey:n,deduplicationDistance:f})}return w}},le=class{constructor(e){this.symbolizer=new Ke(e)}place(e,r,i){let n=i.bbox;if((n.maxY-n.minY)*(n.maxX-n.minX)<2e4)return;let s=this.symbolizer.place(e,[[new Z.default(0,0)]],i);if(!s||s.length==0)return;let o=s[0],l=o.bboxes[0],u=r[0],h=(0,wi.default)([u.map(w=>[w.x,w.y])]),f=new Z.default(h[0],h[1]),c={minX:f.x-(l.maxX-l.minX)/2,minY:f.y-(l.maxY-l.minY)/2,maxX:f.x+(l.maxX-l.minX)/2,maxY:f.y+(l.maxY-l.minY)/2};return[{anchor:f,bboxes:[c],draw:w=>{w.translate(o.anchor.x-(l.maxX-l.minX)/2,o.anchor.y),o.draw(w)}}]}};var Mi=(t,e)=>{let r=Rt(e),i=sr({},t);for(let[n,a]of Object.entries(t)){let s=Rt(a);i[n]=di(r[0],r[1],s[2],s[3])}return i},Pe=(t,e)=>(e&&(t=Mi(t,e)),[{dataLayer:"earth",symbolizer:new A({fill:t.earth})},{dataLayer:"natural",symbolizer:new A({fill:t.glacier}),filter:(r,i)=>i.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new A({fill:t.residential}),filter:(r,i)=>i.props.landuse=="residential"||i.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new A({fill:t.hospital}),filter:(r,i)=>i.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new A({fill:t.cemetery}),filter:(r,i)=>i.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new A({fill:t.school}),filter:(r,i)=>i.props.amenity=="school"||i.props.amenity=="kindergarten"||i.props.amenity=="university"||i.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new A({fill:t.industrial}),filter:(r,i)=>i.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new A({fill:t.wood}),filter:(r,i)=>i.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new A({fill:t.grass}),filter:(r,i)=>i.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new A({fill:t.park}),filter:(r,i)=>i.props.leisure=="park"},{dataLayer:"water",symbolizer:new A({fill:t.water})},{dataLayer:"natural",symbolizer:new A({fill:t.sand}),filter:(r,i)=>i.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new A({fill:t.buildings})},{dataLayer:"roads",symbolizer:new P({color:t.highwayCasing,width:j(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(r,i)=>i.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new P({color:t.majorRoadCasing,width:j(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(r,i)=>i.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new P({color:t.mediumRoadCasing,width:j(1.4,[[13,3],[17,6],[20,18]])}),filter:(r,i)=>i.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new P({color:t.minorRoadCasing,width:j(1.4,[[14,2],[17,5],[20,15]])}),filter:(r,i)=>i.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new P({color:t.minorRoad,width:j(1.4,[[14,1],[17,3],[20,13]])}),filter:(r,i)=>i.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new P({color:t.mediumRoad,width:j(1.4,[[13,2],[17,4],[20,15]])}),filter:(r,i)=>i.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new P({color:t.majorRoad,width:j(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(r,i)=>i.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new P({color:t.highway,width:j(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(r,i)=>i.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new P({color:t.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new A({fill:t.mask})}]),De=(t,e,r,i)=>{e&&(t=Mi(t,e));var n=["name"];r&&(n=r);let a=(s,o)=>i?s instanceof oe?new We([s,new oe({fill:o,label_props:i})]):new We([s,new U({fill:o,label_props:i})]):s;return[{dataLayer:"places",symbolizer:a(new U({label_props:n,fill:t.countryLabel,lineHeight:1.5,font:(s,o)=>s<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),t.countryLabel),filter:(s,o)=>o.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:a(new U({label_props:n,fill:t.stateLabel,font:"300 16px sans-serif"}),t.stateLabel),filter:(s,o)=>o.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(s,o)=>o.props["pmap:kind"]=="city",minzoom:7,symbolizer:a(new U({label_props:n,fill:t.cityLabel,font:(s,o)=>(o==null?void 0:o.props["pmap:rank"])===1?s>8?"600 20px sans-serif":"600 12px sans-serif":s>8?"600 16px sans-serif":"600 10px sans-serif"}),t.cityLabel),sort:(s,o)=>s["pmap:rank"]-o["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(s,o)=>o.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new ge([new te({radius:2,fill:t.cityLabel}),a(new oe({label_props:n,fill:t.cityLabel,offsetX:2,offsetY:2,font:(s,o)=>(o==null?void 0:o.props["pmap:rank"])===1?s>8?"600 20px sans-serif":"600 12px sans-serif":s>8?"600 16px sans-serif":"600 10px sans-serif"}),t.cityLabel)]),sort:(s,o)=>s["pmap:rank"]-o["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new U({label_props:n,fill:t.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),t.neighbourhoodLabel),filter:(s,o)=>o.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new le({label_props:n,fill:t.landuseLabel,font:"300 12px sans-serif"}),t.landuseLabel)},{dataLayer:"water",symbolizer:a(new le({label_props:n,fill:t.waterLabel,font:"italic 600 12px sans-serif"}),t.waterLabel)},{dataLayer:"natural",symbolizer:a(new le({label_props:n,fill:t.naturalLabel,font:"italic 300 12px sans-serif"}),t.naturalLabel)},{dataLayer:"roads",symbolizer:a(new ce({label_props:n,fill:t.roadsLabel,font:"500 12px sans-serif"}),t.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new ut({label_props:["ref"],font:"600 9px sans-serif",background:t.highway,padding:2,fill:t.neighbourhoodLabel}),filter:(s,o)=>o.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new ge([new te({radius:2,fill:t.poisLabel}),a(new oe({label_props:n,fill:t.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),t.poisLabel)])}]};var Ci=(t,e,r)=>[{dataSource:t,dataLayer:e,symbolizer:new te({opacity:.2,fill:r,radius:4}),filter:(i,n)=>n.geomType==ee.Point},{dataSource:t,dataLayer:e,symbolizer:new P({opacity:.2,color:r,width:2}),filter:(i,n)=>n.geomType==ee.Line},{dataSource:t,dataLayer:e,symbolizer:new A({opacity:.2,fill:r,stroke:r,width:1}),filter:(i,n)=>n.geomType==ee.Polygon}],ht=(t,e)=>{var r=[];for(var[i,n]of t)for(var a of n)for(var s of a.data.keys())i===e.dataSource&&s===e.dataLayer||(r=r.concat(Ci(i,s,"steelblue")));return r=r.concat(Ci(e.dataSource||"",e.dataLayer,"red")),r};var Je=6378137,Ti=85.0511287798,J=Je*Math.PI,Pi=t=>{let e=Math.PI/180,r=Math.max(Math.min(Ti,t.y),-Ti),i=Math.sin(r*e);return new ue.default(Je*t.x*e,Je*Math.log((1+i)/(1-i))/2)},Ma=t=>{var e=180/Math.PI;return{lat:(2*Math.atan(Math.exp(t.y/Je))-Math.PI/2)*e,lng:t.x*e/Je}},Ca=(t,e)=>r=>{let i=Pi(r);return new ue.default((i.x+J)/(J*2),1-(i.y+J)/(J*2)).mult((1<<e)*256).sub(t)},Ta=(t,e)=>r=>{let i=new ue.default(r.x,r.y).add(t).div((1<<e)*256),n=new ue.default(i.x*(J*2)-J,(1-i.y)*(J*2)-J);return Ma(n)},qt=(t,e)=>{let r=e*(360/t);return Math.log2(r/256)},Di=class{constructor(e){let r=e.dark?Me:Fe;this.paint_rules=e.paint_rules||Pe(r,e.shade),this.label_rules=e.label_rules||De(r,e.shade,e.language1,e.language2),this.backgroundColor=e.backgroundColor,this.views=Ye(e),this.debug=e.debug||"",this.xray=e.xray}drawContext(e,r,i,n,a){return E(this,null,function*(){let s=Pi(n),l=new ue.default((s.x+J)/(J*2),1-(s.y+J)/(J*2)).clone().mult(Math.pow(2,a)*256).sub(new ue.default(r/2,i/2)),u={minX:l.x,minY:l.y,maxX:l.x+r,maxY:l.y+i},h=[];for(let[p,b]of this.views){let y=b.getBbox(a,u);h.push({key:p,promise:y})}let f=yield Promise.all(h.map(p=>p.promise.then(b=>({status:"fulfilled",value:b,key:p.key}),b=>({status:"rejected",value:[],reason:b,key:p.key})))),c=new Map;for(let p of f)p.status==="fulfilled"&&c.set(p.key,p.value);let g=performance.now(),w=new je(a,e,this.label_rules,16,void 0),v=w.add(c);this.backgroundColor&&(e.save(),e.fillStyle=this.backgroundColor,e.fillRect(0,0,r,i),e.restore());let d=this.paint_rules;this.xray&&(d=ht(c,this.xray));let m=Ue(e,a,c,this.xray?null:w.index,d,u,l,!0,this.debug);if(this.debug){e.save(),e.translate(-l.x,-l.y),e.strokeStyle=this.debug,e.fillStyle=this.debug,e.font="12px sans-serif";let p=0;for(let[b,y]of c){for(let x of y){e.strokeRect(x.origin.x,x.origin.y,x.dim,x.dim);let z=x.data_tile;e.fillText(b+(b?" ":"")+z.z+" "+z.x+" "+z.y,x.origin.x+4,x.origin.y+14*(1+p))}p++}e.restore()}return{elapsed:performance.now()-g,project:Ca(l,a),unproject:Ta(l,a)}})}drawCanvas(a,s,o){return E(this,arguments,function*(e,r,i,n={}){let l=window.devicePixelRatio,u=e.clientWidth,h=e.clientHeight;e.width==u*l&&e.height==h*l||(e.width=u*l,e.height=h*l),n.lang&&(e.lang=n.lang);let f=e.getContext("2d");return f.setTransform(l,0,0,l,0,0),this.drawContext(f,u,h,r,i)})}drawContextBounds(e,r,i,n,a){return E(this,null,function*(){let s=i.x-r.x,o=new ue.default((r.x+i.x)/2,(r.y+i.y)/2);return this.drawContext(e,n,a,o,qt(s,n))})}drawCanvasBounds(s,o,l,u){return E(this,arguments,function*(e,r,i,n,a={}){let h=i.x-r.x,f=new ue.default((r.x+i.x)/2,(r.y+i.y)/2);return this.drawCanvas(e,f,qt(h,n),a)})}};var Ai=Y(ie());var Pa=t=>new Promise((e,r)=>{setTimeout(()=>{e()},t)}),Da=t=>t.then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e})),Aa=(t={})=>{class e extends L.GridLayer{constructor(i={}){i.noWrap&&!i.bounds&&(i.bounds=[[-90,-180],[90,180]]),i.attribution==null&&(i.attribution='<a href="https://protomaps.com">Protomaps</a> \xA9 <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(i);let n=i.dark?Me:Fe;this.paint_rules=i.paint_rules||Pe(n,i.shade),this.label_rules=i.label_rules||De(n,i.shade,i.language1,i.language2),this.backgroundColor=i.backgroundColor,this.lastRequestedZ=void 0,this.xray=i.xray,this.tasks=i.tasks||[],this.views=Ye(i),this.debug=i.debug;let a=document.createElement("canvas").getContext("2d");this.scratch=a,this.onTilesInvalidated=s=>{s.forEach(o=>{this.rerenderTile(o)})},this.labelers=new Ne(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=i.tileDelay||3,this.lang=i.lang,this.inspector=this.inspect(this)}setDefaultStyle(i,n,a,s){let o=i?Me:Fe;this.paint_rules=Pe(o,n),this.label_rules=De(o,n,a,s)}renderTile(i,n,a,s=()=>{}){return E(this,null,function*(){this.lastRequestedZ=i.z;let o=[];for(let[_,k]of this.views){let S=k.getDisplayTile(i);o.push({key:_,promise:S})}let l=yield Promise.all(o.map(_=>_.promise.then(k=>({status:"fulfilled",value:k,key:_.key}),k=>({status:"rejected",reason:k,key:_.key})))),u=new Map;for(let _ of l)_.status==="fulfilled"?u.set(_.key,[_.value]):_.reason.name==="AbortError"||console.error(_.reason);if(n.key!=a||this.lastRequestedZ!==i.z||(yield Promise.all(this.tasks.map(Da)),n.key!=a)||this.lastRequestedZ!==i.z)return;let h=this.labelers.add(i.z,u);if(n.key!=a||this.lastRequestedZ!==i.z)return;let f=this.labelers.getIndex(i.z);if(!this._map)return;let c=this._map.getCenter().wrap(),g=this._getTiledPixelBounds(c),w=this._pxBoundsToTileRange(g),v=w.getCenter(),d=i.distanceTo(v)*this.tileDelay;if(yield Pa(d),n.key!=a||this.lastRequestedZ!==i.z)return;let m=16,p={minX:256*i.x-m,minY:256*i.y-m,maxX:256*(i.x+1)+m,maxY:256*(i.y+1)+m},b=new Ai.default(256*i.x,256*i.y);n.width=this.tile_size,n.height=this.tile_size;let y=n.getContext("2d");y.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),y.clearRect(0,0,256,256),this.backgroundColor&&(y.save(),y.fillStyle=this.backgroundColor,y.fillRect(0,0,256,256),y.restore());var x=0;let z=this.paint_rules;if(this.xray&&(z=ht(u,this.xray)),x=Ue(y,i.z,u,this.xray?null:f,z,p,b,!1,this.debug),this.debug){y.save(),y.fillStyle=this.debug,y.font="600 12px sans-serif",y.fillText(i.z+" "+i.x+" "+i.y,4,14),y.font="12px sans-serif";let _=28;for(let[k,S]of u){let F=S[0].data_tile;y.fillText(k+(k?" ":"")+F.z+" "+F.x+" "+F.y,4,_),_+=14}y.font="600 10px sans-serif",x>8&&(y.fillText(x.toFixed()+" ms paint",4,_),_+=14),h>8&&y.fillText(h.toFixed()+" ms layout",4,_),y.strokeStyle=this.debug,y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(0,256),y.stroke(),y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(256,0),y.stroke(),y.restore()}s()})}rerenderTile(i){for(let n in this._tiles){let a=this._wrapCoords(this._keyToTileCoords(n));i===this._tileCoordsToKey(a)&&this.renderTile(a,this._tiles[n].el,i)}}clearLayout(){this.labelers=new Ne(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let i in this._tiles){let n=this._wrapCoords(this._keyToTileCoords(i)),a=this._tileCoordsToKey(n);this.renderTile(n,this._tiles[i].el,a)}}createTile(i,n){let a=L.DomUtil.create("canvas","leaflet-tile");a.lang=this.lang;let s=this._tileCoordsToKey(i);return a.key=s,this.renderTile(i,a,s,()=>{n(null,a)}),a}_removeTile(i){let n=this._tiles[i];!n||(n.el.removed=!0,n.el.key=void 0,L.DomUtil.removeClass(n.el,"leaflet-tile-loaded"),n.el.width=n.el.height=0,L.DomUtil.remove(n.el),delete this._tiles[i],this.fire("tileunload",{tile:n.el,coords:this._keyToTileCoords(i)}))}queryFeatures(i,n){let a=new Map;for(var[s,o]of this.views)a.set(s,o.queryFeatures(i,n,this._map.getZoom()));return a}inspect(i){return n=>{let a=["\u25CE","\u27CD","\u25FB"],s=i._map.wrapLatLng(n.latlng),o=i.queryFeatures(s.lng,s.lat);var l="";let u=!0;for(var[h,f]of o)for(var c of f)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===h&&this.xray.dataLayer===c.layerName))){l=l+`<div style="margin-top:${u?0:.5}em">${a[c.feature.geomType-1]} <b>${h} ${h?"/":""} ${c.layerName}</b> ${c.feature.id||""}</div>`;for(let g in c.feature.props)l=l+`<div style="font-size:0.9em">${g} = ${c.feature.props[g]}</div>`;u=!1}u&&(l="No features."),L.popup().setLatLng(n.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+l+"</div>").openOn(i._map)}}addInspector(i){return i.on("click",this.inspector)}removeInspector(i){return i.off("click",this.inspector)}}return new e(t)};function Ht(t){let e=0,r=0;for(let o of t)e+=o.w*o.h,r=Math.max(r,o.w);t.sort((o,l)=>l.h-o.h);let i=Math.max(Math.ceil(Math.sqrt(e/.95)),r),n=[{x:0,y:0,w:i,h:1/0}],a=0,s=0;for(let o of t)for(let l=n.length-1;l>=0;l--){let u=n[l];if(!(o.w>u.w||o.h>u.h)){if(o.x=u.x,o.y=u.y,s=Math.max(s,o.y+o.h),a=Math.max(a,o.x+o.w),o.w===u.w&&o.h===u.h){let h=n.pop();l<n.length&&(n[l]=h)}else o.h===u.h?(u.x+=o.w,u.w-=o.w):o.w===u.w?(u.y+=o.h,u.h-=o.h):(n.push({x:u.x+o.w,y:u.y,w:u.w-o.w,h:o.h}),u.y+=o.h,u.h-=o.h);break}}return{w:a,h:s,fill:e/(a*s)||0}}var Zt=(t,e,r)=>{let i=new FontFace(t,"url("+e+")",{weight:r});return document.fonts.add(i),i.load()},Bi=t=>E(void 0,null,function*(){return new Promise((e,r)=>{let i=new Image;i.onload=()=>e(i),i.onerror=()=>r("Invalid SVG"),i.src=t})}),Ba=`
<svg width="20px" height="20px" viewBox="0 0 50 50" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <rect width="50" height="50" fill="#cccccc"/>
    <g transform="translate(5,5)">
        <path fill="none" stroke="#666666" stroke-width="7" d="m11,12a8.5,8 0 1,1 17,0q0,4-4,6t-4.5,4.5-.4,4v.2m0,3v7"/>
    </g>
</svg>
`,Oi=class{constructor(e){this.src=e,this.canvas=document.createElement("canvas"),this.mapping=new Map,this.missingBox={x:0,y:0,w:0,h:0}}load(){return E(this,null,function*(){let e=this.src,r=window.devicePixelRatio;e.endsWith(".html")&&(e=yield(yield fetch(e)).text());let i=new window.DOMParser().parseFromString(e,"text/html"),n=Array.from(i.body.children),a=yield Bi("data:image/svg+xml;base64,"+btoa(Ba)),s=[{w:a.width*r,h:a.height*r,img:a,id:""}],o=new XMLSerializer;for(let c of n){var l=btoa(o.serializeToString(c)),u="data:image/svg+xml;base64,"+l;let g=yield Bi(u);s.push({w:g.width*r,h:g.height*r,img:g,id:c.id})}let h=Ht(s);this.canvas.width=h.w,this.canvas.height=h.h;let f=this.canvas.getContext("2d");if(f)for(let c of s)c.x!==void 0&&c.y!==void 0&&(f.drawImage(c.img,c.x,c.y,c.w,c.h),c.id?this.mapping.set(c.id,{x:c.x,y:c.y,w:c.w,h:c.h}):this.missingBox={x:c.x,y:c.y,w:c.w,h:c.h});return this})}get(e){let r=this.mapping.get(e);return r||(r=this.missingBox),r}};function ft(t,e){return typeof t=="number"?t:e}function Ge(t){if(t.includes("$type"))return e=>!0;if(t[0]=="==")return(e,r)=>r.props[t[1]]===t[2];if(t[0]=="!=")return(e,r)=>r.props[t[1]]!==t[2];if(t[0]=="!"){let e=Ge(t[1]);return(r,i)=>!e(r,i)}else{if(t[0]==="<")return(e,r)=>ft(r.props[t[1]],1/0)<t[2];if(t[0]==="<=")return(e,r)=>ft(r.props[t[1]],1/0)<=t[2];if(t[0]===">")return(e,r)=>ft(r.props[t[1]],-1/0)>t[2];if(t[0]===">=")return(e,r)=>ft(r.props[t[1]],-1/0)>=t[2];if(t[0]==="in")return(e,r)=>t.slice(2,t.length).includes(r.props[t[1]]);if(t[0]==="!in")return(e,r)=>!t.slice(2,t.length).includes(r.props[t[1]]);if(t[0]==="has")return(e,r)=>r.props.hasOwnProperty(t[1]);if(t[0]==="!has")return(e,r)=>!r.props.hasOwnProperty(t[1]);if(t[0]==="all"){let e=t.slice(1,t.length).map(r=>Ge(r));return(r,i)=>e.every(n=>n(r,i))}else if(t[0]==="any"){let e=t.slice(1,t.length).map(r=>Ge(r));return(r,i)=>e.some(n=>n(r,i))}else return console.log("Unimplemented filter: ",t[0]),e=>!1}}function dt(t){if(t.base&&t.stops)return r=>j(t.base,t.stops)(r-1);if(t[0]=="interpolate"&&t[1][0]=="exponential"&&t[2]=="zoom"){let r=t.slice(3),i=[];for(var e=0;e<r.length;e+=2)i.push([r[e],r[e+1]]);return n=>j(t[1][1],i)(n-1)}else if(t[0]=="step"&&t[1][0]=="get"){let r=t.slice(2),i=t[1][1];return(n,a)=>{let s=a==null?void 0:a.props[i];if(typeof s=="number"){if(s<r[1])return r[0];for(e=1;e<r.length;e+=2)if(s<=r[e])return r[e+1]}return r[r.length-1]}}else return console.log("Unimplemented numeric fn: ",t),r=>1}function Wt(t,e=0){return t?typeof t=="number"?t:(r,i)=>i?dt(t)(r,i):e:e}function Kt(t,e){let r=Wt(t,1),i=Wt(e);return(n,a)=>{let s=typeof r=="number"?r:r(n,a);return i?s+(typeof i=="number"?i:i(n,a)):s}}function Jt(t,e){let r=[];for(let o of t["text-font"])e.hasOwnProperty(o)&&r.push(e[o]);r.length===0&&r.push({face:"sans-serif"});let i=t["text-size"];var n="";r.length&&r[0].weight&&(n=r[0].weight+" ");var a="";if(r.length&&r[0].style&&(a=r[0].style+" "),typeof i=="number")return o=>`${a}${n}${i}px ${r.map(l=>l.face).join(", ")}`;if(i.stops){var s=1.4;i.base?s=i.base:i.base=s;let o=dt(i);return(l,u)=>`${a}${n}${o(l,u)}px ${r.map(h=>h.face).join(", ")}`}else if(i[0]=="step"){let o=dt(i);return(l,u)=>`${a}${n}${o(l,u)}px ${r.map(h=>h.face).join(", ")}`}else return console.log("Can't parse font: ",t),o=>"12px sans-serif"}function Oa(t,e){let r=[],i=[],n=new Map;for(var a of t.layers){if(n.set(a.id,a),a.layout&&a.layout.visibility=="none")continue;if(a.ref){let u=n.get(a.ref);a.type=u.type,a.filter=u.filter,a.source=u.source,a["source-layer"]=u["source-layer"]}let l=a["source-layer"];var s,o=void 0;a.filter&&(o=Ge(a.filter)),a.type=="fill"?r.push({dataLayer:a["source-layer"],filter:o,symbolizer:new A({fill:a.paint["fill-color"],opacity:a.paint["fill-opacity"]})}):a.type=="fill-extrusion"?r.push({dataLayer:a["source-layer"],filter:o,symbolizer:new A({fill:a.paint["fill-extrusion-color"],opacity:a.paint["fill-extrusion-opacity"]})}):a.type=="line"?a.paint["line-dasharray"]?r.push({dataLayer:a["source-layer"],filter:o,symbolizer:new P({width:Kt(a.paint["line-width"],a.paint["line-gap-width"]),dash:a.paint["line-dasharray"],dashColor:a.paint["line-color"]})}):r.push({dataLayer:a["source-layer"],filter:o,symbolizer:new P({color:a.paint["line-color"],width:Kt(a.paint["line-width"],a.paint["line-gap-width"])})}):a.type=="symbol"?a.layout["symbol-placement"]=="line"?i.push({dataLayer:a["source-layer"],filter:o,symbolizer:new ce({font:Jt(a.layout,e),fill:a.paint["text-color"],width:a.paint["text-halo-width"],stroke:a.paint["text-halo-color"],textTransform:a.layout["text-transform"],label_props:a.layout["text-field"]?[a.layout["text-field"]]:void 0})}):i.push({dataLayer:a["source-layer"],filter:o,symbolizer:new U({font:Jt(a.layout,e),fill:a.paint["text-color"],stroke:a.paint["text-halo-color"],width:a.paint["text-halo-width"],textTransform:a.layout["text-transform"],label_props:a.layout["text-field"]?[a.layout["text-field"]]:void 0})}):a.type=="circle"&&r.push({dataLayer:a["source-layer"],filter:o,symbolizer:new te({radius:a.paint["circle-radius"],fill:a.paint["circle-color"],stroke:a.paint["circle-stroke-color"],width:a.paint["circle-stroke-width"]})})}return i.reverse(),{paint_rules:r,label_rules:i,tasks:[]}}var Ra=t=>{let e=jt(4,4,s=>{var o=s.getContext("2d");o&&(o.beginPath(),o.rect(0,0,1,1),o.rect(2,2,1,1),o.fillStyle="black",o.fill())});var r="black";t==="lite"&&(r="#d9d9d9");let i=["name:en","name"],n=[{dataLayer:"earth",symbolizer:new A({fill:"white"})},{dataLayer:"landuse",symbolizer:new A({pattern:e}),filter:(s,o)=>o.props.leisure=="park"},{dataLayer:"water",symbolizer:new A({fill:r})},{dataLayer:"roads",symbolizer:new P({color:"#dddddd"}),filter:(s,o)=>o.props["pmap:kind"]==="minor_road"},{dataLayer:"roads",symbolizer:new P({color:"white",width:de(16,[7,9,17,20])}),filter:(s,o)=>o.props["pmap:kind"]==="medium_road"},{dataLayer:"roads",symbolizer:new P({color:"#cccccc",width:de(10,[.2,.2,.2,.4,.8,1.5,4,7,13,16])}),filter:(s,o)=>o.props["pmap:kind"]==="medium_road"},{dataLayer:"roads",symbolizer:new P({color:"white",width:de(11,[1.25,5,5,5,8,11,18,22,30])}),filter:(s,o)=>o.props["pmap:kind"]==="major_road"},{dataLayer:"roads",symbolizer:new P({color:"black",width:de(9,[.15,.5,.7,1,1.5,1.9,5,7,12,18,26])}),filter:(s,o)=>o.props["pmap:kind"]==="major_road"},{dataLayer:"roads",symbolizer:new P({color:"white",width:de(7,[2.25,3.25,4.25,5,6,7,8,9,11,14,24,42,49])}),filter:(s,o)=>o.props["pmap:kind"]==="highway"},{dataLayer:"roads",symbolizer:new P({color:"black",width:de(6,[.1,1.5,1.5,1.5,2,2.5,3,3,4,6,9,15,28,35])}),filter:(s,o)=>o.props["pmap:kind"]==="highway"},{dataLayer:"transit",symbolizer:new P({color:"#888888",dashColor:"#888888",dash:[1,4],dashWidth:3}),filter:(s,o)=>o.props["pmap:kind"]==="railway",minzoom:14},{dataLayer:"transit",symbolizer:new P({color:"#888888"}),filter:(s,o)=>o.props["pmap:kind"]==="railway",minzoom:14},{dataLayer:"buildings",symbolizer:new P({color:"#888888",width:.5})},{dataLayer:"boundaries",symbolizer:new P({color:"black",width:1}),maxzoom:6},{dataLayer:"boundaries",symbolizer:new P({color:"white",width:2.5,dash:[3,1],dashWidth:.3,dashColor:"black"}),minzoom:7}],a=[{dataLayer:"places",symbolizer:new U({label_props:i,fill:"black",stroke:"white",width:1.5,fontFamily:"Inter",fontWeight:300,fontSize:15,justify:V.Center}),filter:(s,o)=>o.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:new U({label_props:i,fill:"black",stroke:"white",width:2,fontFamily:"Inter",fontWeight:300,fontSize:12,justify:V.Center}),filter:(s,o)=>o.props["pmap:kind"]=="state"},{dataLayer:"places",symbolizer:new ge([new te({radius:2,fill:"black",stroke:"white",width:2}),new oe({label_props:i,offsetX:3,fill:"black",stroke:"white",width:1.5,fontFamily:"Inter",fontWeight:600,fontSize:(s,o)=>o.props["pmap:rank"]==1?15:13})]),sort:(s,o)=>s["pmap:rank"]-o["pmap:rank"],filter:(s,o)=>o.props["pmap:kind"]=="city",maxzoom:8},{dataLayer:"places",symbolizer:new U({label_props:i,justify:V.Center,fill:"black",stroke:"white",width:2,fontFamily:"Inter",fontWeight:600,fontSize:(s,o)=>o.props["pmap:rank"]==1?15:13}),sort:(s,o)=>s["pmap:rank"]-o["pmap:rank"],filter:(s,o)=>o.props["pmap:kind"]=="city",minzoom:9},{dataLayer:"water",symbolizer:new le({label_props:i,fill:"white",stroke:"black",width:3,font:"italic 400 12px Inter"})},{dataLayer:"landuse",symbolizer:new le({fill:"black",stroke:"white",width:2,font:"italic 400 12px Inter"})},{dataLayer:"physical_point",symbolizer:new U({label_props:i,fill:"white",stroke:"black",width:3,font:"italic 600 12px Inter",textTransform:"uppercase",justify:V.Center}),filter:(s,o)=>["ocean","sea"].includes(o.props.place)},{dataLayer:"roads",symbolizer:new ce({fill:"black",stroke:"white",width:2,font:"600 14px Inter",offset:4})}];return{tasks:[Zt("Inter","https://cdn.protomaps.com/fonts/woff2/Inter.var.woff2","100 900")],paint_rules:n,label_rules:a,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>.'}};var Ri=Y(Ct());return Ea;})();
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
